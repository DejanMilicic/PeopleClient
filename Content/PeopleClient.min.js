function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
var JSON;JSON||(JSON={}),function(){"use strict";function i(n){return n<10?"0"+n:n}function f(n){return o.lastIndex=0,o.test(n)?'"'+n.replace(o,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function r(i,e){var s,l,h,a,v=n,c,o=e[i];o&&typeof o=="object"&&typeof o.toJSON=="function"&&(o=o.toJSON(i));typeof t=="function"&&(o=t.call(e,i,o));switch(typeof o){case"string":return f(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(n+=u,c=[],Object.prototype.toString.apply(o)==="[object Array]"){for(a=o.length,s=0;s<a;s+=1)c[s]=r(s,o)||"null";return h=c.length===0?"[]":n?"[\n"+n+c.join(",\n"+n)+"\n"+v+"]":"["+c.join(",")+"]",n=v,h}if(t&&typeof t=="object")for(a=t.length,s=0;s<a;s+=1)typeof t[s]=="string"&&(l=t[s],h=r(l,o),h&&c.push(f(l)+(n?": ":":")+h));else for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(h=r(l,o),h&&c.push(f(l)+(n?": ":":")+h));return h=c.length===0?"{}":n?"{\n"+n+c.join(",\n"+n)+"\n"+v+"}":"{"+c.join(",")+"}",n=v,h}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,u,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",u="",typeof e=="number")for(o=0;o<e;o+=1)u+=" ";else typeof e=="string"&&(u=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return r("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),e.lastIndex=0,e.test(n)&&(n=n.replace(e,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}();
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC;a=self;b=a.PeopleClient=a.PeopleClient||{};c=b.App=b.App||{};d=a.WebSharper=a.WebSharper||{};e=d.Operators=d.Operators||{};f=d.Mvu=d.Mvu||{};g=f.App=f.App||{};h=b.StateModule=b.StateModule||{};i=b.Update=b.Update||{};j=b.View=b.View||{};k=a.PeopleClient_JsonEncoder=a.PeopleClient_JsonEncoder||{};l=a.PeopleClient_JsonDecoder=a.PeopleClient_JsonDecoder||{};m=a.PeopleClient_Router=a.PeopleClient_Router||{};n=a.PeopleClient_Templates=a.PeopleClient_Templates||{};o=d.Obj=d.Obj||{};p=f.Pager=f.Pager||{};q=a.StartupCode$PeopleClient$Model=a.StartupCode$PeopleClient$Model||{};r=d.ClientSideJson=d.ClientSideJson||{};s=r.Provider=r.Provider||{};t=b.PersonEditingModule=b.PersonEditingModule||{};u=f.Action=f.Action||{};v=d.Collections=d.Collections||{};w=v.FSharpMap=v.FSharpMap||{};x=d.Seq=d.Seq||{};y=v.Map=v.Map||{};z=d.Option=d.Option||{};A=j.CreatePerson=j.CreatePerson||{};B=j.EditPerson=j.EditPerson||{};C=j.PeopleList=j.PeopleList||{};D=d.UI=d.UI||{};E=D.Var=D.Var||{};F=a.StartupCode$PeopleClient$App=a.StartupCode$PeopleClient$App||{};G=D.Client=D.Client||{};H=G.Templates=G.Templates||{};I=D.Doc=D.Doc||{};J=d.JavaScript=d.JavaScript||{};K=J.Pervasives=J.Pervasives||{};L=d.Ref=d.Ref||{};M=d.Unchecked=d.Unchecked||{};N=d.Lazy=d.Lazy||{};O=J.Promise=J.Promise||{};P=d.Sitelets=d.Sitelets||{};Q=P.RouterModule=P.RouterModule||{};R=v.MapUtil=v.MapUtil||{};S=d.List=d.List||{};T=d.Enumerator=d.Enumerator||{};U=T.T=T.T||{};V=a.StartupCode$PeopleClient$View=a.StartupCode$PeopleClient$View||{};W=D.Router=D.Router||{};X=D.Var$1=D.Var$1||{};Y=D.View=D.View||{};Z=J.JS=J.JS||{};_0=d.Arrays=d.Arrays||{};_1=a.Object;_2=a.EventTarget;_3=a.Node;_4=v.Dictionary=v.Dictionary||{};_5=D.DomUtility=D.DomUtility||{};_6=D.Elt=D.Elt||{};_7=G.EltUpdater=G.EltUpdater||{};_8=d.Numeric=d.Numeric||{};_9=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};_=_9.LazyRecord=_9.LazyRecord||{};$=D.HtmlModule=D.HtmlModule||{};ba=$.attr=$.attr||{};bb=f.Page=f.Page||{};bc=S.T=S.T||{};bd=d.Concurrency=d.Concurrency||{};be=P.Route=P.Route||{};bf=a.StartupCode$PeopleClient$Update=a.StartupCode$PeopleClient$Update||{};bg=v.BalancedTree=v.BalancedTree||{};bh=bg.Tree=bg.Tree||{};bi=v.Pair=v.Pair||{};bj=d.Utils=d.Utils||{};bk=j.Common=j.Common||{};bl=bk.EditFormParams=bk.EditFormParams||{};bm=D.Templating=D.Templating||{};bn=bm.Runtime=bm.Runtime||{};bo=bn.Server=bn.Server||{};bp=bo.TemplateInstance=bo.TemplateInstance||{};bq=bo.ProviderBuilder=bo.ProviderBuilder||{};br=bo.Handler=bo.Handler||{};bs=D.AttrModule=D.AttrModule||{};bt=a.WindowOrWorkerGlobalScope;bu=D.Abbrev=D.Abbrev||{};bv=bu.Fresh=bu.Fresh||{};bw=P.RouterOperators=P.RouterOperators||{};bx=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};by=v.HashSet=v.HashSet||{};bz=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bA=D.Docs=D.Docs||{};bB=D.ConcreteVar=D.ConcreteVar||{};bC=D.Snap=D.Snap||{};bD=D.Updates=D.Updates||{};bE=D.DocElemNode=D.DocElemNode||{};bF=D.AttrProxy=D.AttrProxy||{};bG=bd.AsyncBody=bd.AsyncBody||{};bH=a.Error;bI=J.NonStandardPromiseRejectionException=J.NonStandardPromiseRejectionException||{};bJ=P.Router=P.Router||{};bK=P.PathUtil=P.PathUtil||{};bL=d.Strings=d.Strings||{};bM=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bN=v.List=v.List||{};bO=a.System=a.System||{};bP=bO.Guid=bO.Guid||{};bQ=D.Attrs=D.Attrs||{};bR=bn.Client=bn.Client||{};bS=P.List=P.List||{};bT=v.DictionaryUtil=v.DictionaryUtil||{};bU=H.Prepare=H.Prepare||{};bV=d.Slice=d.Slice||{};bW=v.KeyCollection=v.KeyCollection||{};bX=a.CharacterData;bY=D.An=D.An||{};bZ=G.Settings=G.Settings||{};b0=bu.Mailbox=bu.Mailbox||{};b1=bd.CT=bd.CT||{};b2=G.Attrs=G.Attrs||{};b3=b2.Dyn=b2.Dyn||{};b4=d.InvalidOperationException=d.InvalidOperationException||{};b5=bd.Scheduler=bd.Scheduler||{};b6=d.CancellationTokenSource=d.CancellationTokenSource||{};b7=D.FromView=D.FromView||{};b8=D.CheckedInput=D.CheckedInput||{};b9=D.Array=D.Array||{};b_=D.DynamicAttrNode=D.DynamicAttrNode||{};b$=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};ca=a.StartupCode$WebSharper_Sitelets$Router=a.StartupCode$WebSharper_Sitelets$Router||{};cb=G.Docs=G.Docs||{};cc=cb.RunState=cb.RunState||{};cd=cb.NodeSet=cb.NodeSet||{};ce=D.Anims=D.Anims||{};cf=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};cg=d.OperationCanceledException=d.OperationCanceledException||{};ch=P.StringEncoding=P.StringEncoding||{};ci=d.Char=d.Char||{};cj=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};ck=D.AppendList=D.AppendList||{};cl=v.HashSetUtil=v.HashSetUtil||{};cm=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};cn=D.Easing=D.Easing||{};co=bu.HashSet=bu.HashSet||{};cp=d.Queue=d.Queue||{};cq=cb.DomNodes=cb.DomNodes||{};cr=D.String=D.String||{};cs=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};ct=d.FormatException=d.FormatException||{};cu=a.console;cv=a.IntelliFactory;cw=cv&&cv.Runtime;cx=a.JSON;cy=a.Number;cz=a.jQuery;cA=a.Math;cB=a.Date;cC=a.String;c.Main=function(){var cD,cE;cD=g.Run(g.WithLog(function(cF,cG){cu.log((k.j())(cF));return cu.log((k.j$4())(cG));},g.WithInitMessage({$:2,$0:false},(cE=g.CreatePaged(h.Init(),i.UpdateApp,j.Page),g.WithCustomRouting(c.router(),function(cF){return cF.Page;},i.Goto,cE)))));H.LoadLocalTemplates("");I.RunById("main",cD);};c.router=function(){F.$cctor();return F.router;};e.FailWith=function(cD){throw new bH(cD);};e.InvalidOp=function(cD){throw new b4.New(cD);};e.KeyValue=function(cD){return[cD.K,cD.V];};g.CreatePaged=function(cD,cE,cF){function cG(cH,cI){return(new p.New(cF,cH,cI)).get_Doc();}return g.Create(cD,cE,function(cH){return function(cI){return cG(cH,cI);};});};g.WithCustomRouting=function(cD,cE,cF,cG){return g.withRouting(X.Lens(cG.Var,cE,function(cH,cI){return cF(cI,cH);}),cD,cE,cG);};g.WithInitMessage=function(cD,cE){return g.WithInitAction({$:3,$0:function(cF){cF(cD);}},cE);};g.WithLog=function(cD,cE){function cF(cG,cH,cI){var cJ;cJ=((cE.Update(cG))(cH))(cI);cD(cH,cJ==null?cI:cJ.$0);return cJ;}return g.New(cE.Init,cE.Var,cE.View,cw.Curried3(cF),cE.Render);};g.Run=function(cD){function cE(cF){cD.Var.UpdateMaybe((cD.Update(cE))(cF));}cD.Init(cE);return(cD.Render(cE))(cD.View);};g.Create=function(cD,cE,cF){function cG(cH,cI,cJ){return g.applyAction(cH,cJ,cE(cI,cJ));}return g.create(cD,cw.Curried3(cG),cF);};g.withRouting=function(cD,cE,cF,cG){return g.New(function(cH){cG.Init(cH);W.InstallHashInto(cD,cF(cG.Var.Get()),cE);},cG.Var,cG.View,cG.Update,cG.Render);};g.WithInitAction=function(cD,cE){return g.New(function(cF){var cG;cE.Init(cF);cG=g.applyAction(cF,cE.Var.Get(),cD);cG==null?void 0:cE.Var.Set(cG.$0);},cE.Var,cE.View,cE.Update,cE.Render);};g.create=function(cD,cE,cF){var cG;cG=X.Create$1(cD);return g.New(a.ignore,cG,cG.get_View(),cE,cF);};g.applyAction=function(cD,cE,cF){function cG(cH,cI){var cJ;cJ=g.applyAction(cD,cH==null?cE:cH.$0,cI);return cJ==null?cH:cJ;}return cF.$==1?{$:1,$0:cF.$0}:cF.$==2?{$:1,$0:cF.$0(cE)}:cF.$==3?(cF.$0(cD),null):cF.$==4?(bd.Start(cF.$0(cD),null),null):cF.$==5?(((cw.Curried3(x.fold))(cG))(null))(cF.$0):null;};h.Init=function(){q.$cctor();return q.Init;};i.UpdateApp=function(cD,cE){var cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO;return cD.$==1?{$:1,$0:{People:cE.People,Refreshing:cE.Refreshing,Error:cE.Error,Page:cE.Page,Editing:i.UpdatePerson(cD.$0,cE.Editing),Deleting:cE.Deleting}}:cD.$==2?(cF=cD.$0,i.DispatchAjax({$:0},function(cP){return{$:8,$0:((s.DecodeArray(l.j))())(cx.parse(cP)),$1:cF};})):cD.$==3?(cG=t.TryToData(0,cE.Editing),cG!=null&&cG.$==1?i.DispatchAjax({$:2,$0:cG.$0},function(){return{$:2,$0:true};}):{$:1,$0:{People:cE.People,Refreshing:cE.Refreshing,Error:{$:1,$0:"Invalid person"},Page:cE.Page,Editing:cE.Editing,Deleting:cE.Deleting}}):cD.$==4?(cH=t.TryToData(cD.$0,cE.Editing),cH!=null&&cH.$==1?i.DispatchAjax({$:3,$0:cH.$0},function(){return{$:2,$0:true};}):{$:1,$0:{People:cE.People,Refreshing:cE.Refreshing,Error:{$:1,$0:"Invalid person"},Page:cE.Page,Editing:cE.Editing,Deleting:cE.Deleting}}):cD.$==5?{$:1,$0:{People:cE.People,Refreshing:cE.Refreshing,Error:cE.Error,Page:cE.Page,Editing:cE.Editing,Deleting:{$:1,$0:cD.$0}}}:cD.$==7?{$:1,$0:{People:cE.People,Refreshing:cE.Refreshing,Error:cE.Error,Page:cE.Page,Editing:cE.Editing,Deleting:null}}:cD.$==6?(cI=cE.Deleting,cI!=null&&cI.$==1?i.DispatchAjax({$:4,$0:cI.$0},function(){return{$:2,$0:true};}):u.DoNothing):cD.$==8?(cJ=cD.$0,(cK=new w.New(S.ofSeq(x.delay(function(){return x.map(function(cP){return[cP.id,cP];},cJ);}))),(cL=cD.$1?{$:0}:cE.Page,{$:1,$0:{People:cK,Refreshing:false,Error:null,Page:cL,Editing:cL.$==2?(cM=(cN=y.TryFind(cL.$0,cK),cN==null?null:{$:1,$0:t.OfData(cN.$0)}),cM==null?cE.Editing:cM.$0):cE.Editing,Deleting:null}}))):cD.$==9?{$:1,$0:{People:cE.People,Refreshing:false,Error:{$:1,$0:cD.$0},Page:cE.Page,Editing:cE.Editing,Deleting:cE.Deleting}}:(cO=cD.$0,{$:2,$0:function(cP){return i.Goto(cO,cP);}});};i.Goto=function(cD,cE){var cF,cG,cH;return cD.$==1?{People:cE.People,Refreshing:cE.Refreshing,Error:cE.Error,Page:{$:1},Editing:h.Init().Editing,Deleting:cE.Deleting}:cD.$==2?(cF=cD.$0,{People:cE.People,Refreshing:cE.Refreshing,Error:cE.Error,Page:{$:2,$0:cF},Editing:(cG=(cH=y.TryFind(cF,cE.People),cH==null?null:{$:1,$0:t.OfData(cH.$0)}),cG==null?cE.Editing:cG.$0),Deleting:cE.Deleting}):{People:cE.People,Refreshing:cE.Refreshing,Error:cE.Error,Page:{$:0},Editing:cE.Editing,Deleting:cE.Deleting};};i.UpdatePerson=function(cD,cE){return cD.$==1?{FirstName:cE.FirstName,LastName:cD.$0,Born:cE.Born,HasDied:cE.HasDied,Died:cE.Died}:cD.$==2?{FirstName:cE.FirstName,LastName:cE.LastName,Born:cD.$0,HasDied:cE.HasDied,Died:cE.Died}:cD.$==3?{FirstName:cE.FirstName,LastName:cE.LastName,Born:cE.Born,HasDied:cE.HasDied,Died:cD.$0}:cD.$==4?{FirstName:cE.FirstName,LastName:cE.LastName,Born:cE.Born,HasDied:cD.$0,Died:cE.Died}:{FirstName:cD.$0,LastName:cE.LastName,Born:cE.Born,HasDied:cE.HasDied,Died:cE.Died};};i.DispatchAjax=function(cD,cE){return u.op_Addition({$:2,$0:function(cF){return{People:cF.People,Refreshing:true,Error:cF.Error,Page:cF.Page,Editing:cF.Editing,Deleting:cF.Deleting};}},{$:4,$0:function(cF){var cG;cG=null;return bd.Delay(function(){return bd.TryWith(bd.Delay(function(){var cH;function cI(){var cJ,cK,cL;return(cJ={$:1,$0:cw.DeleteEmptyFields({DefaultAllows:(cK=null,cK?cK.$0:void 0),EndPoint:(cL={$:1,$0:cD},cL?cL.$0:void 0)},["DefaultAllows","EndPoint"])},Q.FetchWith({$:1,$0:"https://peopleapi.websharper.com"},{},i.route(),cJ)).then(function(cM){return cM.text();});}return bd.Bind(O.AsAsync((cH=null,new a.Promise(function(cJ){cJ(cI());}))),function(cJ){cF(cE(cJ));return bd.Zero();});}),function(cH){cF({$:9,$0:cH.message});return bd.Zero();});});}});};i.route=function(){bf.$cctor();return bf.route;};j.Page=function(cD){var cE;cE=cD.Page;return cE.$==1?(A.Page())():cE.$==2?(B.Page())(cE.$0):(C.Page())();};k.j=function(){return k._v?k._v:k._v=(s.EncodeUnion(void 0,"type",[["Goto",[["$0","page",k.j$3,0]]],["UpdateEditing",[["$0","msg",k.j$2,0]]],["RefreshList",[["$0","gotoList",s.Id(),0]]],["SubmitCreatePerson",[]],["SubmitEditPerson",[["$0","id",s.Id(),0]]],["RequestDeletePerson",[["$0","id",s.Id(),0]]],["ConfirmDeletePerson",[]],["CancelDeletePerson",[]],["ListRefreshed",[["$0","people",s.EncodeArray(k.j$1),0],["$1","gotoList",s.Id(),0]]],["Error",[["$0","error",s.Id(),0]]]]))();};k.j$4=function(){return k._v$4?k._v$4:k._v$4=(s.EncodeRecord(void 0,[["People",s.EncodeArrayMap(s.Id(),k.j$1),0],["Refreshing",s.Id(),0],["Error",s.Id(),1],["Page",k.j$3,0],["Editing",s.Id(),0],["Deleting",s.Id(),1]]))();};l.j=function(){return l._v?l._v:l._v=(s.DecodeRecord(void 0,[["id",s.Id(),0],["firstName",s.Id(),0],["lastName",s.Id(),0],["born",s.DecodeDateTime(),0],["died",s.DecodeDateTime(),1]]))();};k.j$3=function(){return k._v$3?k._v$3:k._v$3=(s.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item",s.Id(),0]]]]))();};k.j$2=function(){return k._v$2?k._v$2:k._v$2=(s.EncodeUnion(void 0,{hasDied:4,died:3,born:2,lastName:1,firstName:0},[["SetFirstName",[["$0","firstName",s.Id(),0]]],["SetLastName",[["$0","lastName",s.Id(),0]]],["SetBorn",[["$0","born",s.Id(),0]]],["SetDied",[["$0","died",s.Id(),0]]],["SetHasDied",[["$0","hasDied",s.Id(),0]]]]))();};k.j$1=function(){return k._v$1?k._v$1:k._v$1=(s.EncodeRecord(void 0,[["id",s.Id(),0],["firstName",s.Id(),0],["lastName",s.Id(),0],["born",s.EncodeDateTime(),0],["died",s.EncodeDateTime(),1]]))();};m.r$2=function(){return bw.JSUnion(void 0,[[null,[[null,[]]],[]],[null,[[null,["create"]]],[]],[null,[[null,["edit"]]],[bw.rInt()]]]);};n.table=function(cD){H.LoadLocalTemplates("index");return cD?H.NamedTemplate("index",{$:1,$0:"table"},cD):void 0;};m.r$1=function(){return bw.JSUnion(void 0,[[null,[[null,[]]],[]],[null,[[null,["api"]]],[bw.rCors(m.r())]]]);};n.form=function(cD){H.LoadLocalTemplates("index");return cD?H.NamedTemplate("index",{$:1,$0:"form"},cD):void 0;};n.row=function(cD){H.LoadLocalTemplates("index");return cD?H.NamedTemplate("index",{$:1,$0:"row"},cD):void 0;};m.r=function(){return bw.JSUnion(void 0,[[null,[[{$:1,$0:"GET"},["people"]]],[]],[null,[[{$:1,$0:"GET"},["people"]]],[bw.rInt()]],[null,[[{$:1,$0:"POST"},["people"]]],[Q.Body(function(cD){try{return{$:1,$0:(l.j())(cx.parse(cD))};}catch(cE){return null;}},function(cD){return cx.stringify((k.j$1())(cD));})]],[null,[[{$:1,$0:"PUT"},["people"]]],[Q.Body(function(cD){try{return{$:1,$0:(l.j())(cx.parse(cD))};}catch(cE){return null;}},function(cD){return cx.stringify((k.j$1())(cD));})]],[null,[[{$:1,$0:"DELETE"},["people"]]],[bw.rInt()]]]);};o=d.Obj=cw.Class({Equals:function(cD){return this===cD;},GetHashCode:function(){return -1;}},null,o);o.New=cw.Ctor(function(){},o);p=f.Pager=cw.Class({get_Doc:function(){return this.container$1;},container$2:function(){var cD;function cE(cF,cG){var cH,cI,cJ,cK,cL,cM,cN,cO;cJ=cD.render(cG);cK=((cJ.Render(d.checkThis(cD["this"][0])))(cD.dispatch))(cD.model);cL=cK.elt;cM=cF.childNodes;for(cN=0,cO=cM.length-1;cN<=cO;cN++)if(cM[cN]!==cL)cM[cN].setAttribute("aria-hidden","true");cL.removeAttribute("aria-hidden");cH=cD.toRemove;cH!=null&&cH.$==1?cH.$0!==cK?(cI=cH.$0,cJ.UsesTransition?cI.elt.dataset.wsRemoving="true":cF.removeChild(cI.elt),N.Force(cD.container).RemoveUpdated(cI)):void 0:void 0;!cF.contains(cL)?(cL.setAttribute("aria-hidden","true"),cF.appendChild(cL),N.Force(cD.container).AddUpdated(cK),a.requestAnimationFrame(function(){cL.removeAttribute("aria-hidden");})):void 0;return cD.toRemove=cJ.KeepInDom?null:{$:1,$0:cK};}cD=this;return I.Element("div",[bF.Create("class","ws-page-container"),bs.DynamicCustom(function(cF){return function(cG){return cE(cF,cG);};},this.model)],[]).ToUpdater();},RemoveIfNeeded:function(cD){if(cD.dataset.wsRemoving==="true"){cD.dataset.wsRemoving="false";this.container$1.elt.removeChild(cD);}}},o,p);p.New=cw.Ctor(function(cD,cE,cF){var cG;cG=this;o.New.call(this);this["this"]=L.New(null);new o.New();this.render=cD;this.dispatch=cE;this.model=cF;this["this"][0]=this;this.toRemove=null;this.container=N.Create(function(){return cG.container$2();});this.container$1=N.Force(this.container);this.init=1;},p);q.$cctor=function(){q.$cctor=a.ignore;q.Init={People:new w.New([]),Refreshing:true,Error:null,Page:{$:0},Editing:{FirstName:"",LastName:"",Born:"",HasDied:false,Died:""},Deleting:null};};s.DecodeArray=function(cD){return s.EncodeArray(cD);};s.EncodeUnion=function(cD,cE,cF){return function(){return function(cG){var cH,cI;function cJ(cK,cL,cM,cN){var cO,cP,cQ;if(cK===null){cO=(cM(null))(cG.$0);for(var cR in cO)if(function(cS){cH[cS]=cO[cS];return false;}(cR))break;}else if(cN===0)cH[cL]=(cM(null))(cG[cK]);else if(cN===1){cQ=cG[cK];cQ==null?void 0:cH[cL]=(cM(null))(cQ.$0);}else e.FailWith("Invalid field option kind");}return typeof cG==="object"&&cG!=null?(cH={},(cI=_0.get(cF,cG.$),(M.Equals(typeof cE,"string")?cH[cE]=cI[0]:void 0,_0.iter(function(cK){return cJ(cK[0],cK[1],cK[2],cK[3]);},cI[1]),cH))):cG;};};};s.Id=cw.Curried3(function(cD,cE,cF){return cF;});s.EncodeArray=cw.Curried3(function(cD,cE,cF){return _0.map(cD(),cF);});s.EncodeRecord=function(cD,cE){return function(){return function(cF){var cG;function cH(cI,cJ,cK){var cL;if(cK===0)cG[cI]=(cJ(null))(cF[cI]);else if(cK===1){cL=cF[cI];cL==null?void 0:cG[cI]=(cJ(null))(cL.$0);}else if(cK===2){if(cF.hasOwnProperty(cI))cG[cI]=(cJ(null))(cF[cI]);}else if(cK===3){if(cF[cI]===void 0)cG[cI]=(cJ(null))(cF[cI]);}else e.FailWith("Invalid field option kind");}cG={};_0.iter(function(cI){return cH(cI[0],cI[1],cI[2]);},cE);return cG;};};};s.EncodeArrayMap=function(cD,cE){return function(){return function(cF){var cG,cH,cI;cG=[];cH=cD();cI=cE();y.Iterate(function(cJ,cK){var cL;cL=[[cH(cJ),cI(cK)]],cG.push.apply(cG,cL);},cF);return cG;};};};s.DecodeRecord=function(cD,cE){return function(){return function(cF){var cG;function cH(cI,cJ,cK){if(cK===0){if(cF.hasOwnProperty(cI))cG[cI]=(cJ(null))(cF[cI]);else e.FailWith("Missing mandatory field: "+cI);}else if(cK===1)cG[cI]=cF.hasOwnProperty(cI)?{$:1,$0:(cJ(null))(cF[cI])}:null;else if(cK===2){if(cF.hasOwnProperty(cI))cG[cI]=(cJ(null))(cF[cI]);}else if(cK===3){if(cF[cI]===void 0)cG[cI]=(cJ(null))(cF[cI]);}else e.FailWith("Invalid field option kind");}cG=cD===void 0?{}:new cD();_0.iter(function(cI){return cH(cI[0],cI[1],cI[2]);},cE);return cG;};};};s.DecodeDateTime=cw.Curried3(function(cD,cE,cF){return cF.hasOwnProperty("d")?(new a.Date(cF.d)).getTime():(new a.Date(cF)).getTime();});s.EncodeDateTime=cw.Curried3(function(cD,cE,cF){return(new a.Date(cF)).toISOString();});t.TryToData=function(cD,cE){var cF,cG,cH,cI;cF=t.TryParseDate(cE.Born);return cF!=null&&cF.$==1?(cG=cE.HasDied,(cH=t.TryParseDate(cE.Died),(cG?cH==null||(cI=[cH,cG],false):(cI=[cH,cG],false))?null:{$:1,$0:{id:cD,firstName:cE.FirstName,lastName:cE.LastName,born:cF.$0,died:cI[1]?cI[0]:null}})):null;};t.OfData=function(cD){var cE;return{FirstName:cD.firstName,LastName:cD.lastName,Born:t.DateToString(cD.born),HasDied:cD.died!=null,Died:(cE=cD.died,cE!=null&&cE.$==1?t.DateToString(cE.$0):"")};};t.TryParseDate=function(cD){var cE;cE=new a.Date(cD);return cy.isNaN(cE.getTime())?null:{$:1,$0:cE.getTime()};};t.DateToString=function(cD){return((((cw.Curried(function(cE,cF,cG,cH){return cE(bj.padNumLeft(a.String(cF),4)+"-"+bj.padNumLeft(a.String(cG),2)+"-"+bj.padNumLeft(a.String(cH),2));},4))(a.id))((new a.Date(cD)).getFullYear()))((new a.Date(cD)).getMonth()+1))((new a.Date(cD)).getDate());};u.DoNothing={$:0};u.op_Addition=function(cD,cE){return cE.$==0?cD:cE.$==5?cD.$==0?cE:cD.$==5?{$:5,$0:S.append(cD.$0,cE.$0)}:{$:5,$0:new bc({$:1,$0:cD,$1:cE.$0})}:cD.$==0?cE:cD.$==5?{$:5,$0:S.append(cD.$0,S.ofArray([cE]))}:{$:5,$0:S.ofArray([cD,cE])};};w=v.FSharpMap=cw.Class({TryFind:function(cD){var cE;cE=bg.TryFind(bi.New(cD,void 0),this.tree);return cE==null?null:{$:1,$0:cE.$0.Value};},get_IsEmpty:function(){return this.tree==null;},Equals:function(cD){return this.get_Count()===cD.get_Count()&&x.forall2(M.Equals,this,cD);},GetEnumerator$1:function(){return T.Get(x.map(function(cD){return{K:cD.Key,V:cD.Value};},bg.Enumerate(false,this.tree)));},get_Count:function(){var cD;cD=this.tree;return cD==null?0:cD.Count;},Add:function(cD,cE){return new w.New$1(bg.Add(bi.New(cD,cE),this.tree));},get_Tree:function(){return this.tree;},GetHashCode:function(){return M.Hash(_0.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(cD){return x.compareWith(M.Compare,this,cD);}},o,w);w.New=cw.Ctor(function(cD){w.New$1.call(this,R.fromSeq(cD));},w);w.New$1=cw.Ctor(function(cD){o.New.call(this);this.tree=cD;},w);x.delay=function(cD){return{GetEnumerator:function(){return T.Get(cD());}};};x.map=function(cD,cE){return{GetEnumerator:function(){var cF;cF=T.Get(cE);return new U.New(null,null,function(cG){return cF.MoveNext()&&(cG.c=cD(cF.Current()),true);},function(){cF.Dispose();});}};};x.collect=function(cD,cE){return x.concat(x.map(cD,cE));};x.distinctBy=function(cD,cE){return{GetEnumerator:function(){var cF,cG;cF=T.Get(cE);cG=new by.New$3();return new U.New(null,null,function(cH){var cI,cJ;if(cF.MoveNext()){cI=cF.Current();cJ=cG.Add(cD(cI));while(!cJ&&cF.MoveNext()){cI=cF.Current();cJ=cG.Add(cD(cI));}return cJ&&(cH.c=cI,true);}else return false;},function(){cF.Dispose();});}};};x.iter=function(cD,cE){var cF;cF=T.Get(cE);try{while(cF.MoveNext())cD(cF.Current());}finally{if(typeof cF=="object"&&"Dispose"in cF)cF.Dispose();}};x.head=function(cD){var cE;cE=T.Get(cD);try{return cE.MoveNext()?cE.Current():x.insufficient();}finally{if(typeof cE=="object"&&"Dispose"in cE)cE.Dispose();}};x.fold=function(cD,cE,cF){var cG,cH;cG=cE;cH=T.Get(cF);try{while(cH.MoveNext())cG=cD(cG,cH.Current());return cG;}finally{if(typeof cH=="object"&&"Dispose"in cH)cH.Dispose();}};x.concat=function(cD){return{GetEnumerator:function(){var cE;cE=T.Get(cD);return new U.New(null,null,function(cF){var cG;while(true){cG=cF.s;if(M.Equals(cG,null)){if(cE.MoveNext()){cF.s=T.Get(cE.Current());cF=cF;}else{cE.Dispose();return false;}}else if(cG.MoveNext()){cF.c=cG.Current();return true;}else{cF.Dispose();cF.s=null;cF=cF;}}},function(cF){var cG;cG=cF.s;!M.Equals(cG,null)?cG.Dispose():void 0;!M.Equals(cE,null)?cE.Dispose():void 0;});}};};x.append=function(cD,cE){return{GetEnumerator:function(){var cF,cG;cF=T.Get(cD);cG=[true];return new U.New(cF,null,function(cH){var cI;return cH.s.MoveNext()?(cH.c=cH.s.Current(),true):(cI=cH.s,!M.Equals(cI,null)?cI.Dispose():void 0,cH.s=null,cG[0]&&(cG[0]=false,cH.s=T.Get(cE),cH.s.MoveNext()?(cH.c=cH.s.Current(),true):(cH.s.Dispose(),cH.s=null,false)));},function(cH){var cI;cI=cH.s;!M.Equals(cI,null)?cI.Dispose():void 0;});}};};x.tryPick=function(cD,cE){var cF,cG;cF=T.Get(cE);try{cG=null;while(M.Equals(cG,null)&&cF.MoveNext())cG=cD(cF.Current());return cG;}finally{if(typeof cF=="object"&&"Dispose"in cF)cF.Dispose();}};x.iteri=function(cD,cE){var cF,cG;cF=0;cG=T.Get(cE);try{while(cG.MoveNext()){cD(cF,cG.Current());cF=cF+1;}}finally{if(typeof cG=="object"&&"Dispose"in cG)cG.Dispose();}};x.indexed=function(cD){return x.mapi(function(cE,cF){return[cE,cF];},cD);};x.tryFindIndex=function(cD,cE){var cF,cG,cH;cF=T.Get(cE);try{cG=true;cH=0;while(cG&&cF.MoveNext())if(cD(cF.Current()))cG=false;else cH=cH+1;return cG?null:{$:1,$0:cH};}finally{if(typeof cF=="object"&&"Dispose"in cF)cF.Dispose();}};x.mapi=function(cD,cE){return x.map2(cD,x.initInfinite(a.id),cE);};x.forall2=function(cD,cE,cF){return!x.exists2(function(cG,cH){return!cD(cG,cH);},cE,cF);};x.map2=function(cD,cE,cF){return{GetEnumerator:function(){var cG,cH;cG=T.Get(cE);cH=T.Get(cF);return new U.New(null,null,function(cI){return cG.MoveNext()&&cH.MoveNext()&&(cI.c=cD(cG.Current(),cH.Current()),true);},function(){cG.Dispose();cH.Dispose();});}};};x.initInfinite=function(cD){return{GetEnumerator:function(){return new U.New(0,null,function(cE){cE.c=cD(cE.s);cE.s=cE.s+1;return true;},void 0);}};};x.exists2=function(cD,cE,cF){var cG,cH,cI,cJ;cG=T.Get(cE);try{cI=T.Get(cF);try{cJ=false;while(!cJ&&cG.MoveNext()&&cI.MoveNext())cJ=cD(cG.Current(),cI.Current());cH=cJ;}finally{if(typeof cI=="object"&&"Dispose"in cI)cI.Dispose();}return cH;}finally{if(typeof cG=="object"&&"Dispose"in cG)cG.Dispose();}};x.compareWith=function(cD,cE,cF){var cG,cH,cI,cJ,cK;cG=T.Get(cE);try{cI=T.Get(cF);try{cJ=0;cK=true;while(cK&&cJ===0)if(cG.MoveNext())cJ=cI.MoveNext()?cD(cG.Current(),cI.Current()):1;else if(cI.MoveNext())cJ=-1;else cK=false;cH=cJ;}finally{if(typeof cI=="object"&&"Dispose"in cI)cI.Dispose();}return cH;}finally{if(typeof cG=="object"&&"Dispose"in cG)cG.Dispose();}};x.unfold=function(cD,cE){return{GetEnumerator:function(){return new U.New(cE,null,function(cF){var cG;cG=cD(cF.s);return cG==null?false:(cF.c=cG.$0[0],cF.s=cG.$0[1],true);},void 0);}};};x.max=function(cD){var cE,cF,cG;cE=T.Get(cD);try{if(!cE.MoveNext())x.seqEmpty();cF=cE.Current();while(cE.MoveNext()){cG=cE.Current();M.Compare(cG,cF)===1?cF=cG:void 0;}return cF;}finally{if(typeof cE=="object"&&"Dispose"in cE)cE.Dispose();}};x.distinct=function(cD){return x.distinctBy(a.id,cD);};x.seqEmpty=function(){return e.FailWith("The input sequence was empty.");};x.forall=function(cD,cE){return!x.exists(function(cF){return!cD(cF);},cE);};x.exists=function(cD,cE){var cF,cG;cF=T.Get(cE);try{cG=false;while(!cG&&cF.MoveNext())cG=cD(cF.Current());return cG;}finally{if(typeof cF=="object"&&"Dispose"in cF)cF.Dispose();}};y.TryFind=function(cD,cE){return cE.TryFind(cD);};y.Iterate=function(cD,cE){x.iter(function(cF){cD(cF.K,cF.V);},cE);};y.FoldBack=function(cD,cE,cF){return x.fold(function(cG,cH){return cD(cH.Key,cH.Value,cG);},cF,bg.Enumerate(true,cE.get_Tree()));};y.ToSeq=function(cD){return x.map(function(cE){return[cE.Key,cE.Value];},bg.Enumerate(false,cD.get_Tree()));};y.OfArray=function(cD){return new w.New$1(bg.OfSeq(x.map(function(cE){return bi.New(cE[0],cE[1]);},cD)));};z.ofObj=function(cD){return cD==null?null:{$:1,$0:cD};};A.Page=function(){V.$cctor();return V.Page$1;};B.Page=function(){V.$cctor();return V.Page;};C.Page=function(){V.$cctor();return V.Page$2;};C.PersonRow=function(cD,cE,cF,cG){var cH,cI,cJ,cK,cL,cM,cN;return(cH=(cI=bk.DisabledWhenRefreshing(cE),(cJ=(cK=bk.DisabledWhenRefreshing(cE),(cL=bq.Make$1().WithHole({$:2,$0:"firstname",$1:Y.Map(function(cO){return cO.firstName;},cG)}).WithHole({$:2,$0:"lastname",$1:Y.Map(function(cO){return cO.lastName;},cG)}).WithHole({$:2,$0:"born",$1:Y.Map(function(cO){var cP;cP=cO.born;return(new a.Date(cP)).toLocaleDateString();},cG)}).WithHole({$:2,$0:"died",$1:Y.Map(function(cO){var cP;cP=cO.died;return cP!=null&&cP.$==1?(new a.Date(cP.$0)).toLocaleDateString():"";},cG)}),cL.WithHole(br.EventQ2(cL.k,"edit",function(){return cL.i;},function(){cD({$:0,$0:{$:2,$0:cF}});}))).WithHole({$:3,$0:"editattr",$1:cK})),cJ.WithHole(br.EventQ2(cJ.k,"delete",function(){return cJ.i;},function(){cD({$:5,$0:cF});}))).WithHole({$:3,$0:"deleteattr",$1:cI})),(cM=br.CompleteHoles(cH.k,cH.h,[]),(cN=new bp.New(cM[1],n.row(cM[0])),(cH.i=cN,cN)))).get_Doc();};E=D.Var=cw.Class({},o,E);E.New=cw.Ctor(function(){o.New.call(this);},E);g.New=function(cD,cE,cF,cG,cH){return{Init:cD,Var:cE,View:cF,Update:cG,Render:cH};};F.$cctor=function(){F.$cctor=a.ignore;F.router=m.r$2();};H.LoadLocalTemplates=function(cD){!H.LocalTemplatesLoaded()?(H.set_LocalTemplatesLoaded(true),H.LoadNestedTemplates(self.document.body,"")):void 0;H.LoadedTemplates().set_Item(cD,H.LoadedTemplateFile(""));};H.LocalTemplatesLoaded=function(){bx.$cctor();return bx.LocalTemplatesLoaded;};H.set_LocalTemplatesLoaded=function(cD){bx.$cctor();bx.LocalTemplatesLoaded=cD;};H.LoadNestedTemplates=function(cD,cE){var cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT;function cF(cU){var cV,cW;if(!cG.ContainsKey(cU)){cV=(cW=null,[cH.TryGetValue(cU,{get:function(){return cW;},set:function(cX){cW=cX;}}),cW]);cV[0]?(cT.Add(cU),cH.Remove(cU),H.PrepareTemplateStrict(cE,{$:1,$0:cU},cV[1][0],{$:1,$0:cV[1][1]},{$:1,$0:cF})):cu.warn(cT.Contains(cU)?"Encountered loop when instantiating "+cU:"Local template does not exist: "+cU);}}cG=H.LoadedTemplateFile(cE);cH=new _4.New$5();cI=cD.querySelectorAll("[ws-template]");for(cJ=0,cK=cI.length-1;cJ<=cK;cJ++){cL=cI[cJ];cM=cL.getAttribute("ws-template").toLowerCase();cL.removeAttribute("ws-template");cH.set_Item(cM,[[cL],H.FakeRootSingle(cL)]);}cN=cD.querySelectorAll("[ws-children-template]");for(cO=0,cP=cN.length-1;cO<=cP;cO++){cQ=cN[cO];cR=cQ.getAttribute("ws-children-template").toLowerCase();cQ.removeAttribute("ws-children-template");cH.set_Item(cR,(cS=_5.ChildrenArray(cQ),[cS,H.FakeRoot(cS)]));}cT=new by.New$3();while(cH.count>0)cF(x.head(cH.get_Keys()));};H.LoadedTemplates=function(){bx.$cctor();return bx.LoadedTemplates;};H.LoadedTemplateFile=function(cD){var cE,cF,cG;cE=(cF=null,[H.LoadedTemplates().TryGetValue(cD,{get:function(){return cF;},set:function(cH){cF=cH;}}),cF]);return cE[0]?cE[1]:(cG=new _4.New$5(),(H.LoadedTemplates().set_Item(cD,cG),cG));};H.FakeRootSingle=function(cD){var cE,cF,cG;cD.removeAttribute("ws-template");cE=cD.getAttribute("ws-replace");cE===null?void 0:(cD.removeAttribute("ws-replace"),cF=cD.parentNode,M.Equals(cF,null)?void 0:(cG=self.document.createElement(cD.tagName),cG.setAttribute("ws-replace",cE),cF.replaceChild(cG,cD)));return H.FakeRoot([cD]);};H.FakeRoot=function(cD){var cE,cF,cG;cE=self.document.createElement("div");for(cF=0,cG=cD.length-1;cF<=cG;cF++)cE.appendChild(_0.get(cD,cF));return cE;};H.PrepareTemplateStrict=function(cD,cE,cF,cG,cH){var cI,cJ;function cK(cP,cQ){var cR,cS,cT,cU,cV,cX,cY,cZ,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,c_,c$,da,db,dc,dd,de,df;function cW(dg){}while(true)switch(cP){case 0:if(cQ!==null){cR=cQ.nextSibling;if(M.Equals(cQ.nodeType,_3.TEXT_NODE))bU.convertTextNode(cQ);else if(M.Equals(cQ.nodeType,_3.ELEMENT_NODE))cM(cQ);cQ=cR;}else return null;break;case 1:cX=bV.string(cQ.nodeName,{$:1,$0:3},null).toLowerCase();cY=(cS=cX.indexOf("."),cS===-1?[cD,cX]:[bV.string(cX,null,{$:1,$0:cS-1}),bV.string(cX,{$:1,$0:cS+1},null)]);cZ=cY[1];c0=cY[0];if(c0!==""&&!H.LoadedTemplates().ContainsKey(c0))return bU.failNotLoaded(cZ);else{if(c0===""&&cH!=null)cH.$0(cZ);c1=H.LoadedTemplates().get_Item(c0);if(!c1.ContainsKey(cZ))return bU.failNotLoaded(cZ);else{c2=c1.get_Item(cZ);c3=c2.cloneNode(true);c4=new by.New$3();c5=new _4.New$5();c6=cQ.attributes;for(c7=0,c8=c6.length-1;c7<=c8;c7++){c9=c6.item(c7).name.toLowerCase();c5.set_Item(c9,(c_=c6.item(c7).nodeValue,c_===""?c9:c_.toLowerCase()));!c4.Add(c9)?cu.warn("Hole mapped twice",c9):void 0;}for(c$=0,da=cQ.childNodes.length-1;c$<=da;c$++){db=cQ.childNodes[c$];M.Equals(db.nodeType,_3.ELEMENT_NODE)?!c4.Add(db.nodeName.toLowerCase())?cu.warn("Hole filled twice",cZ):void 0:void 0;}dc=cQ.childNodes.length===1&&M.Equals(cQ.firstChild.nodeType,_3.TEXT_NODE);if(dc){cU=bU.fillTextHole(c3,cQ.firstChild.textContent,cZ);((function(dg){return function(dh){if(dh!=null)dg(dh.$0);};}((cV=function(dg){return function(dh){return dg.Add(dh);};}(c4),function(dg){return cW(cV(dg));})))(cU));}bU.removeHolesExcept(c3,c4);if(!dc){for(dd=0,de=cQ.childNodes.length-1;dd<=de;dd++){df=cQ.childNodes[dd];M.Equals(df.nodeType,_3.ELEMENT_NODE)?df.hasAttributes()?bU.fillInstanceAttrs(c3,df):cL(c3,df):void 0;}}bU.mapHoles(c3,c5);bU.fill(c3,cQ.parentNode,cQ);cQ.parentNode.removeChild(cQ);return;}}break;}}function cL(cP,cQ){var cR,cT,cU;function cS(cV,cW){var cX,cY,cZ;if(cT==="title"&&cQ.hasChildNodes()){cX=cz.parseHTML(cQ.textContent);cQ.removeChild(cQ.firstChild);for(cY=0,cZ=cX.length-1;cY<=cZ;cY++)cQ.appendChild(_0.get(cX,cY));}else null;cM(cQ);return bU.fill(cQ,cV,cW);}cT=cQ.nodeName.toLowerCase();_5.IterSelector(cP,"[ws-attr-holes]",function(cV){var cW,cX,cY,cZ,c0;cW=bL.SplitChars(cV.getAttribute("ws-attr-holes"),[" "],1);for(cX=0,cY=cW.length-1;cX<=cY;cX++){cZ=_0.get(cW,cX);cV.setAttribute(cZ,(c0=new a.RegExp("\\${"+cT+"}","ig"),cV.getAttribute(cZ).replace(c0,cQ.textContent)));}});cU=cP.querySelector("[ws-hole="+cT+"]");if(M.Equals(cU,null)){cR=cP.querySelector("[ws-replace="+cT+"]");return M.Equals(cR,null)?null:(cS(cR.parentNode,cR),void cR.parentNode.removeChild(cR));}else{while(cU.hasChildNodes())cU.removeChild(cU.lastChild);cU.removeAttribute("ws-hole");return cS(cU,null);}}function cM(cP){if(bL.StartsWith(cP.nodeName.toLowerCase(),"ws-"))cO(cP);else{bU.convertAttrs(cP);cN(cP.firstChild);}}function cN(cP){return cK(0,cP);}function cO(cP){return cK(1,cP);}cI=cG==null?H.FakeRoot(cF):cG.$0;cJ=(cE==null?"":cE.$0).toLowerCase();H.LoadedTemplateFile(cD).set_Item(cJ,cI);_0.length(cF)>0?(function(cP){var cQ,cR,cS,cT;while(true){cQ=cP.querySelector("[ws-template]");if(M.Equals(cQ,null)){cR=cP.querySelector("[ws-children-template]");if(M.Equals(cR,null))return null;else{cS=cR.getAttribute("ws-children-template");cR.removeAttribute("ws-children-template");H.PrepareTemplateStrict(cD,{$:1,$0:cS},_5.ChildrenArray(cR),null,null);cP=cP;}}else{cT=cQ.getAttribute("ws-template");(H.PrepareSingleTemplate(cD,{$:1,$0:cT},cQ))(null);cP=cP;}}}(cI),cN(_0.get(cF,0))):void 0;};H.PrepareSingleTemplate=function(cD,cE,cF){var cG,cH,cI;cG=H.FakeRootSingle(cF);cH=[cF];cI={$:1,$0:cG};return function(cJ){H.PrepareTemplateStrict(cD,cE,cH,cI,cJ);};};H.NamedTemplate=function(cD,cE,cF){var cG,cH;cG=(cH=null,[H.LoadedTemplateFile(cD).TryGetValue(cE==null?"":cE.$0,{get:function(){return cH;},set:function(cI){cH=cI;}}),cH]);return cG[0]?H.ChildrenTemplate(cG[1].cloneNode(true),cF):(cu.warn("Local template doesn't exist",cE),I.get_Empty());};H.TextHoleRE=function(){bx.$cctor();return bx.TextHoleRE;};H.ChildrenTemplate=function(cD,cE){var cF,cG,cH,cI,cJ;cF=H.InlineTemplate(cD,cE);cG=cF[1];cH=cF[0];cI=cH.Els;return!M.Equals(cI,null)&&cI.length===1&&(_0.get(cI,0)instanceof _3&&(M.Equals(_0.get(cI,0).nodeType,_3.ELEMENT_NODE)&&(cJ=_0.get(cI,0),true)))?_6.TreeNode(cH,cG):I.Mk({$:6,$0:cH},cG);};H.InlineTemplate=function(cD,cE){var cF,cG,cH,cI,cL,cM,cN,cO,cP,cQ,cR;function cJ(cS,cT){var cU,cV,cW;cU=bQ.Insert(cS,cT);cM.push(bQ.Updates(cU));cN.push([cS,cU]);cV=cw.GetOptional(cU.OnAfterRender);return cV==null?null:(cW=cV.$0,void cO.push(function(){cW(cS);}));}function cK(cS){var cT,cU;cT=(cU=null,[cP.TryGetValue(cS,{get:function(){return cU;},set:function(cV){cU=cV;}}),cU]);return cT[0]?cT[1].$==0?{$:1,$0:cT[1].$1}:cT[1].$==1?{$:1,$0:I.TextNode(cT[1].$1)}:cT[1].$==2?{$:1,$0:I.TextView(cT[1].$1)}:cT[1].$==8?{$:1,$0:I.TextView(cT[1].$1.get_View())}:cT[1].$==9?{$:1,$0:I.TextView(Y.Map(a.String,cT[1].$1.get_View()))}:cT[1].$==10?{$:1,$0:I.TextView(Y.Map(function(cV){return cV.get_Input();},cT[1].$1.get_View()))}:cT[1].$==11?{$:1,$0:I.TextView(Y.Map(a.String,cT[1].$1.get_View()))}:cT[1].$==12?{$:1,$0:I.TextView(Y.Map(function(cV){return cV.get_Input();},cT[1].$1.get_View()))}:cT[1].$==13?{$:1,$0:I.TextView(Y.Map(a.String,cT[1].$1.get_View()))}:(cu.warn("Content hole filled with attribute data",cS),null):null;}cL=[];cM=[];cN=[];cO=[];cP=new _4.New$5();cQ=T.Get(cE);try{while(cQ.MoveNext()){cR=cQ.Current();cP.set_Item(cR.$0,cR);}}finally{if(typeof cQ=="object"&&"Dispose"in cQ)cQ.Dispose();}cF=_5.ChildrenArray(cD);_5.IterSelector(cD,"[ws-hole]",function(cS){var cT,cU,cV;cV=cS.getAttribute("ws-hole");cS.removeAttribute("ws-hole");while(cS.hasChildNodes())cS.removeChild(cS.lastChild);cT=cK(cV);cT!=null&&cT.$==1?(cU=cT.$0,bA.LinkElement(cS,cU.docNode),cL.push(bE.New(bQ.Empty(cS),cU.docNode,null,cS,bv.Int(),null)),cM.push(cU.updates)):void 0;});_5.IterSelector(cD,"[ws-replace]",function(cS){var cT,cU,cV,cW,cX,cY;cT=cK(cS.getAttribute("ws-replace"));cT!=null&&cT.$==1?(cU=cT.$0,cV=cS.parentNode,cW=self.document.createTextNode(""),cV.replaceChild(cW,cS),cX=bA.InsertBeforeDelim(cW,cU.docNode),cY=_0.tryFindIndex(function(cZ){return cS===cZ;},cF),cY==null?void 0:_0.set(cF,cY.$0,cU.docNode),cL.push(bE.New(bQ.Empty(cV),cU.docNode,{$:1,$0:[cX,cW]},cV,bv.Int(),null)),cM.push(cU.updates)):void 0;});_5.IterSelector(cD,"[ws-attr]",function(cS){var cT,cU,cV;cT=cS.getAttribute("ws-attr");cS.removeAttribute("ws-attr");cU=(cV=null,[cP.TryGetValue(cT,{get:function(){return cV;},set:function(cW){cV=cW;}}),cV]);cU[0]?cU[1].$==3?cJ(cS,cU[1].$1):cu.warn("Attribute hole filled with non-attribute data",cT):void 0;});_5.IterSelector(cD,"[ws-on]",function(cS){cJ(cS,bF.Concat(_0.choose(function(cT){var cU,cV,cW;cU=bL.SplitChars(cT,[":"],1);cV=(cW=null,[cP.TryGetValue(_0.get(cU,1),{get:function(){return cW;},set:function(cX){cW=cX;}}),cW]);return cV[0]?cV[1].$==4?{$:1,$0:bs.Handler(_0.get(cU,0),cV[1].$1)}:cV[1].$==5?{$:1,$0:bF.Handler(_0.get(cU,0),cV[1].$2)}:(cu.warn("Event hole on"+_0.get(cU,0)+" filled with non-event data",_0.get(cU,1)),null):null;},bL.SplitChars(cS.getAttribute("ws-on"),[" "],1))));cS.removeAttribute("ws-on");});_5.IterSelector(cD,"[ws-onafterrender]",function(cS){var cT,cU,cV;cT=cS.getAttribute("ws-onafterrender");cU=(cV=null,[cP.TryGetValue(cT,{get:function(){return cV;},set:function(cW){cV=cW;}}),cV]);cU[0]?cU[1].$==6?(cS.removeAttribute("ws-onafterrender"),cJ(cS,bs.OnAfterRender(cU[1].$1))):cU[1].$==7?(cS.removeAttribute("ws-onafterrender"),cJ(cS,bs.OnAfterRender(cU[1].$1))):cu.warn("onafterrender hole filled with non-onafterrender data",cT):void 0;});_5.IterSelector(cD,"[ws-var]",function(cS){var cT,cU,cV;cT=cS.getAttribute("ws-var");cS.removeAttribute("ws-var");cU=(cV=null,[cP.TryGetValue(cT,{get:function(){return cV;},set:function(cW){cV=cW;}}),cV]);cU[0]?cU[1].$==8?cJ(cS,bs.Value(cU[1].$1)):cU[1].$==9?cJ(cS,bs.Checked(cU[1].$1)):cU[1].$==10?cJ(cS,bs.IntValue(cU[1].$1)):cU[1].$==11?cJ(cS,bs.IntValueUnchecked(cU[1].$1)):cU[1].$==12?cJ(cS,bs.FloatValue(cU[1].$1)):cU[1].$==13?cJ(cS,bs.FloatValueUnchecked(cU[1].$1)):cu.warn("Var hole filled with non-Var data",cT):void 0;});_5.IterSelector(cD,"[ws-attr-holes]",function(cS){var cT,cU,cV,cW;cT=new a.RegExp(H.TextHoleRE(),"g");cU=bL.SplitChars(cS.getAttribute("ws-attr-holes"),[" "],1);cS.removeAttribute("ws-attr-holes");for(cV=0,cW=cU.length-1;cV<=cW;cV++)(function(){var cX,cY,cZ,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9;c6=_0.get(cU,cV);c7=cS.getAttribute(c6);cX=null;cY=0;c8=[];while(cX=cT.exec(c7),cX!==null){c9=bV.string(c7,{$:1,$0:cY},{$:1,$0:cT.lastIndex-_0.get(cX,0).length-1});cY=cT.lastIndex;c8.push([c9,_0.get(cX,1)]);}c0=bV.string(c7,{$:1,$0:cY},null);cT.lastIndex=0;c1=_0.foldBack(function(c_,c$){return(function(da){var db,dc;db=da[0];dc=da[1];return function(dd){var de,df,dg,dh,di;de=dd[0];df=dd[1];dg=(dh=(di=null,[cP.TryGetValue(dc,{get:function(){return di;},set:function(dj){di=dj;}}),di]),dh[0]?dh[1].$==1?{$:0,$0:dh[1].$1}:dh[1].$==2?{$:1,$0:dh[1].$1}:dh[1].$==8?{$:1,$0:dh[1].$1.get_View()}:dh[1].$==9?{$:1,$0:Y.Map(a.String,dh[1].$1.get_View())}:dh[1].$==10?{$:1,$0:Y.Map(function(dj){return dj.get_Input();},dh[1].$1.get_View())}:dh[1].$==11?{$:1,$0:Y.Map(a.String,dh[1].$1.get_View())}:dh[1].$==12?{$:1,$0:Y.Map(function(dj){return dj.get_Input();},dh[1].$1.get_View())}:dh[1].$==13?{$:1,$0:Y.Map(a.String,dh[1].$1.get_View())}:(cu.warn("Attribute value hole filled with non-text data",dc),{$:0,$0:""}):{$:0,$0:""});return dg.$==1?[db,new bc({$:1,$0:de===""?dg.$0:Y.Map(function(dj){return dj+de;},dg.$0),$1:df})]:[db+dg.$0+de,df];};}(c_))(c$);},c8,[c0,bc.Empty]);return cJ(cS,c1[1].$==1?c1[1].$1.$==1?c1[1].$1.$1.$==1?c1[1].$1.$1.$1.$==0?(c2=c1[0],bs.Dynamic(c6,Y.Map3(function(c_,c$,da){return c2+c_+c$+da;},c1[1].$0,c1[1].$1.$0,c1[1].$1.$1.$0))):(c3=c1[0],bs.Dynamic(c6,Y.Map(function(c_){return c3+bL.concat("",c_);},Y.Sequence(c1[1])))):(c4=c1[0],bs.Dynamic(c6,Y.Map2(function(c_,c$){return c4+c_+c$;},c1[1].$0,c1[1].$1.$0))):c1[0]===""?bs.Dynamic(c6,c1[1].$0):(c5=c1[0],bs.Dynamic(c6,Y.Map(function(c_){return c5+c_;},c1[1].$0))):bF.Create(c6,c1[0]));}());});return[cw.DeleteEmptyFields({Els:cF,Dirty:true,Holes:cL,Attrs:cN,Render:(cG=cO.length==0?null:{$:1,$0:function(cS){_0.iter(function(cT){cT(cS);},cO);}},cG?cG.$0:void 0),El:(cH=!M.Equals(cF,null)&&cF.length===1&&(_0.get(cF,0)instanceof _3&&(_0.get(cF,0)instanceof a.Element&&(cI=_0.get(cF,0),true)))?{$:1,$0:cI}:null,cH?cH.$0:void 0)},["Render","El"]),b9.TreeReduce(Y.Const(),Y.Map2Unit,cM)];};I=D.Doc=cw.Class({},o,I);I.RunById=function(cD,cE){var cF;cF=_5.Doc().getElementById(cD);M.Equals(cF,null)?e.FailWith("invalid id: "+cD):I.Run(cF,cE);};I.Run=function(cD,cE){bA.LinkElement(cD,cE.docNode);I.RunInPlace(false,cD,cE);};I.RunInPlace=function(cD,cE,cF){var cG;cG=bA.CreateRunState(cE,cF.docNode);Y.Sink(bY.get_UseAnimations()||bZ.BatchUpdatesEnabled()?b0.StartProcessor(bA.PerformAnimatedUpdate(cD,cG,cF.docNode)):function(){bA.PerformSyncUpdate(cD,cG,cF.docNode);},cF.updates);};I.Element=function(cD,cE,cF){var cG,cH;cG=bF.Concat(cE);cH=I.Concat(cF);return _6.New(_5.CreateElement(cD),cG,cH);};I.Concat=function(cD){var cE;cE=b9.ofSeqNonCopying(cD);return b9.TreeReduce(I.get_Empty(),I.Append,cE);};I.ConvertSeqBy=function(cD,cE,cF){return I.Flatten(Y.MapSeqCachedViewBy(cD,function(cG,cH){return(cE(cG))(cH);},cF));};I.Append=function(cD,cE){return I.Mk({$:0,$0:cD.docNode,$1:cE.docNode},Y.Map2Unit(cD.updates,cE.updates));};I.get_Empty=function(){return I.Mk(null,Y.Const());};I.Flatten=function(cD){return I.EmbedView(Y.Map(I.Concat,cD));};I.Mk=function(cD,cE){return new I.New(cD,cE);};I.EmbedView=function(cD){var cE;cE=bA.CreateEmbedNode();return I.Mk({$:2,$0:cE},Y.Map(a.ignore,Y.Bind(function(cF){bA.UpdateEmbedNode(cE,cF.docNode);return cF.updates;},cD)));};I.TextNode=function(cD){return I.Mk({$:5,$0:_5.CreateText(cD)},Y.Const());};I.TextView=function(cD){var cE;cE=bA.CreateTextNode();return I.Mk({$:4,$0:cE},Y.Map(function(cF){bA.UpdateTextNode(cE,cF);},cD));};I.New=cw.Ctor(function(cD,cE){o.New.call(this);this.docNode=cD;this.updates=cE;},I);K.NewFromSeq=function(cD){var cE,cF,cG;cE={};cF=T.Get(cD);try{while(cF.MoveNext()){cG=cF.Current();cE[cG[0]]=cG[1];}}finally{if(typeof cF=="object"&&"Dispose"in cF)cF.Dispose();}return cE;};L.New=function(cD){return[cD];};M.Equals=function(cD,cE){var cF,cG,cH,cI;if(cD===cE)return true;else{cF=typeof cD;if(cF=="object"){if(cD===null||cD===void 0||cE===null||cE===void 0)return false;else if("Equals"in cD)return cD.Equals(cE);else if(cD instanceof a.Array&&cE instanceof a.Array)return M.arrayEquals(cD,cE);else if(cD instanceof a.Date&&cE instanceof a.Date)return M.dateEquals(cD,cE);else{cG=[true];for(var cJ in cD)if(function(cK){cG[0]=!cD.hasOwnProperty(cK)||cE.hasOwnProperty(cK)&&M.Equals(cD[cK],cE[cK]);return!cG[0];}(cJ))break;if(cG[0]){for(var cK in cE)if(function(cL){cG[0]=!cE.hasOwnProperty(cL)||cD.hasOwnProperty(cL);return!cG[0];}(cK))break;}return cG[0];}}else return cF=="function"&&("$Func"in cD?cD.$Func===cE.$Func&&cD.$Target===cE.$Target:"$Invokes"in cD&&"$Invokes"in cE&&M.arrayEquals(cD.$Invokes,cE.$Invokes));}};M.arrayEquals=function(cD,cE){var cF,cG;if(_0.length(cD)===_0.length(cE)){cF=true;cG=0;while(cF&&cG<_0.length(cD)){!M.Equals(_0.get(cD,cG),_0.get(cE,cG))?cF=false:void 0;cG=cG+1;}return cF;}else return false;};M.dateEquals=function(cD,cE){return cD.getTime()===cE.getTime();};M.Compare=function(cD,cE){var cF,cG,cH,cI,cJ,cK;if(cD===cE)return 0;else{cG=typeof cD;switch(cG=="function"?1:cG=="boolean"?2:cG=="number"?2:cG=="string"?2:cG=="object"?3:0){case 0:return typeof cE=="undefined"?0:-1;case 1:return e.FailWith("Cannot compare function values.");case 2:return cD<cE?-1:1;case 3:if(cD===null)cH=-1;else if(cE===null)cH=1;else if("CompareTo"in cD)cH=cD.CompareTo(cE);else if("CompareTo0"in cD)cH=cD.CompareTo0(cE);else if(cD instanceof a.Array&&cE instanceof a.Array)cH=M.compareArrays(cD,cE);else if(cD instanceof a.Date&&cE instanceof a.Date)cH=M.compareDates(cD,cE);else{cI=[0];for(var cL in cD)if(function(cM){return!cD.hasOwnProperty(cM)?false:!cE.hasOwnProperty(cM)?(cI[0]=1,true):(cI[0]=M.Compare(cD[cM],cE[cM]),cI[0]!==0);}(cL))break;if(cI[0]===0){for(var cM in cE)if(function(cN){return!cE.hasOwnProperty(cN)?false:!cD.hasOwnProperty(cN)&&(cI[0]=-1,true);}(cM))break;}cH=cI[0];}return cH;}}};M.Hash=function(cD){var cE;cE=typeof cD;return cE=="function"?0:cE=="boolean"?cD?1:0:cE=="number"?cD:cE=="string"?M.hashString(cD):cE=="object"?cD==null?0:cD instanceof a.Array?M.hashArray(cD):M.hashObject(cD):0;};M.compareArrays=function(cD,cE){var cF,cG;if(_0.length(cD)<_0.length(cE))return -1;else if(_0.length(cD)>_0.length(cE))return 1;else{cF=0;cG=0;while(cF===0&&cG<_0.length(cD)){cF=M.Compare(_0.get(cD,cG),_0.get(cE,cG));cG=cG+1;}return cF;}};M.compareDates=function(cD,cE){return M.Compare(cD.getTime(),cE.getTime());};M.hashString=function(cD){var cE,cF,cG;if(cD===null)return 0;else{cE=5381;for(cF=0,cG=cD.length-1;cF<=cG;cF++)cE=M.hashMix(cE,cD[cF].charCodeAt());return cE;}};M.hashArray=function(cD){var cE,cF,cG;cE=-34948909;for(cF=0,cG=_0.length(cD)-1;cF<=cG;cF++)cE=M.hashMix(cE,M.Hash(_0.get(cD,cF)));return cE;};M.hashObject=function(cD){var cE,cF;if("GetHashCode"in cD)return cD.GetHashCode();else{cE=[0];for(var cG in cD)if(function(cH){cE[0]=M.hashMix(M.hashMix(cE[0],M.hashString(cH)),M.Hash(cD[cH]));return false;}(cG))break;return cE[0];}};M.hashMix=function(cD,cE){return(cD<<5)+cD+cE;};N.Create=function(cD){return _.New(false,cD,N.forceLazy);};N.Force=function(cD){return cD.f();};N.forceLazy=function(){var cD;cD=this.v();this.c=true;this.v=cD;this.f=N.cachedLazy;return cD;};N.cachedLazy=function(){return this.v;};N.CreateFromValue=function(cD){return _.New(true,cD,N.cachedLazy);};O.AsAsync=function(cD){return bd.FromContinuations(function(cE,cF){cD.then(cE,function(cG){return cF(O.unwrapExn(cG));});});};O.unwrapExn=function(cD){return cD instanceof bH?cD:new bI.New(cD);};Q.FetchWith=function(cD,cE,cF,cG){var cH,cI,cJ,cK,cL,cM,cN;cH=cE?cE:{};cI=Q.Write(cF,cG);return cI!=null&&cI.$==1?(cJ=cI.$0,(cH.method=(cK=cJ.Method,cK==null?"POST":cK.$0),cL=cJ.Body.f(),cL===null?!cJ.FormData.get_IsEmpty()?(cM=new a.FormData(),y.Iterate(function(cO,cP){return cM.append(cO,cP);},cJ.FormData),cH.body=cM):void 0:cH.body=cL,cN=cJ.ToLink(),self.fetch(cD==null?cN:bL.TrimEnd(cD.$0,["/"])+cN,cH))):e.FailWith("Failed to map endpoint to request");};Q.Write=function(cD,cE){var cF;cF=cD.Write(cE);return cF==null?null:{$:1,$0:be.Combine(cF.$0)};};Q.Parse=function(cD,cE){function cF(cG,cH){return cG.Segments.$==0?{$:1,$0:cH}:null;}return x.tryPick(function(cG){return cF(cG[0],cG[1]);},cD.Parse(cE));};Q.HashLink=function(cD,cE){return"#"+Q.Link(cD,cE);};Q.Link=function(cD,cE){var cF;cF=Q.Write(cD,cE);return cF==null?"":cF.$0.ToLink();};Q.Body=function(cD,cE){return bJ.New$1(function(cF){var cG,cH;cG=cF.Body.f();return cG===null?[]:(cH=cD(cG),cH!=null&&cH.$==1?[[be.New(cF.Segments,cF.QueryArgs,cF.FormData,cF.Method,N.CreateFromValue(null)),cH.$0]]:[]);},function(cF){var cG;return{$:1,$0:[(cG=be.get_Empty(),be.New(cG.Segments,cG.QueryArgs,cG.FormData,cG.Method,N.CreateFromValue(cE(cF))))]};});};R.fromSeq=function(cD){var cE;cE=_0.ofSeq(x.delay(function(){return x.collect(function(cF){return[bi.New(cF[0],cF[1])];},x.distinctBy(function(cF){return cF[0];},cD));}));_0.sortInPlace(cE);return bg.Build(cE,0,cE.length-1);};S.ofSeq=function(cD){var cE,cF,cG,cH,cI,cJ;if(cD instanceof bc)return cD;else if(cD instanceof a.Array)return S.ofArray(cD);else{cE=T.Get(cD);try{cG=cE.MoveNext();if(!cG)cF=bc.Empty;else{cI=new bc({$:1});cH=cI;while(cG){cH.$0=cE.Current();cE.MoveNext()?cH=(cJ=new bc({$:1}),cH.$1=cJ,cJ):cG=false;}cH.$1=bc.Empty;cF=cI;}return cF;}finally{if(typeof cE=="object"&&"Dispose"in cE)cE.Dispose();}}};S.ofArray=function(cD){var cE,cF,cG;cE=bc.Empty;for(cF=_0.length(cD)-1,cG=0;cF>=cG;cF--)cE=new bc({$:1,$0:_0.get(cD,cF),$1:cE});return cE;};S.append=function(cD,cE){var cF,cG,cH,cI,cJ;if(cD.$==0)return cE;else if(cE.$==0)return cD;else{cI=new bc({$:1});cF=cI;cG=cD;cH=true;while(cH){cF.$0=cG.$0;cG=cG.$1;cG.$==0?cH=false:cF=(cJ=new bc({$:1}),cF.$1=cJ,cJ);}cF.$1=cE;return cI;}};S.rev=function(cD){var cE,cF;cE=bc.Empty;cF=cD;while(cF.$==1){cE=new bc({$:1,$0:cF.$0,$1:cE});cF=cF.$1;}return cE;};S.iter=function(cD,cE){var cF;cF=cE;while(cF.$==1){cD(S.head(cF));cF=S.tail(cF);}};S.head=function(cD){return cD.$==1?cD.$0:S.listEmpty();};S.tail=function(cD){return cD.$==1?cD.$1:S.listEmpty();};S.listEmpty=function(){return e.FailWith("The input list was empty.");};T.Get=function(cD){return cD instanceof a.Array?T.ArrayEnumerator(cD):M.Equals(typeof cD,"string")?T.StringEnumerator(cD):cD.GetEnumerator();};T.ArrayEnumerator=function(cD){return new U.New(0,null,function(cE){var cF;cF=cE.s;return cF<_0.length(cD)&&(cE.c=_0.get(cD,cF),cE.s=cF+1,true);},void 0);};T.StringEnumerator=function(cD){return new U.New(0,null,function(cE){var cF;cF=cE.s;return cF<cD.length&&(cE.c=cD[cF],cE.s=cF+1,true);},void 0);};T.Get0=function(cD){return cD instanceof a.Array?T.ArrayEnumerator(cD):M.Equals(typeof cD,"string")?T.StringEnumerator(cD):"GetEnumerator0"in cD?cD.GetEnumerator0():cD.GetEnumerator();};U=T.T=cw.Class({Dispose:function(){if(this.d)this.d(this);},MoveNext:function(){return this.n(this);},Current:function(){return this.c;}},o,U);U.New=cw.Ctor(function(cD,cE,cF,cG){o.New.call(this);this.s=cD;this.c=cE;this.n=cF;this.d=cG;},U);V.$cctor=function(){V.$cctor=a.ignore;V.Page=bb.Create(function(cD,cE,cF){return bk.EditForm(cE,cF,bl.New("Edit",{$:4,$0:cD}));},null,null,null);V.Page$1=bb.Single(function(cD){return function(cE){return bk.EditForm(cD,cE,bl.New("Create",{$:3}));};},null,null,null);V.Page$2=bb.Single(function(cD){return function(cE){var cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ;function cR(cS,cT){return C.PersonRow(cD,cE,cS,cT);}return(cF=(cG=(cH=bk.DisabledWhenRefreshing(cE),(cI=(cJ=bs.DynamicClassPred("is-active",Y.Map(function(cS){return cS.Deleting!=null;},cE)),(cK=bk.DisabledWhenRefreshing(cE),(cL=(cM=bk.DisabledWhenRefreshing(cE),(cN=(cO=I.ConvertSeqBy(function(cS){return cS.K;},function(cS){return function(cT){return cR(cS,Y.Map(function(cU){return cU.V;},cT));};},Y.Map(function(cS){return cS.People;},cE)),bq.Make$1().WithHole({$:0,$0:"body",$1:cO})),cN.WithHole(br.EventQ2(cN.k,"create",function(){return cN.i;},function(){cD({$:0,$0:{$:1}});}))).WithHole({$:3,$0:"createattr",$1:cM})),cL.WithHole(br.EventQ2(cL.k,"refresh",function(){return cL.i;},function(){cD({$:2,$0:false});}))).WithHole({$:3,$0:"refreshattr",$1:cK})).WithHole({$:3,$0:"deletemodalattr",$1:cJ})),cI.WithHole(br.EventQ2(cI.k,"deleteconfirm",function(){return cI.i;},function(){cD({$:6});}))).WithHole({$:3,$0:"deleteconfirmattr",$1:cH})),cG.WithHole(br.EventQ2(cG.k,"deletecancel",function(){return cG.i;},function(){cD({$:7});}))),(cP=br.CompleteHoles(cF.k,cF.h,[]),(cQ=new bp.New(cP[1],n.table(cP[0])),(cF.i=cQ,cQ)))).get_Doc();};},null,null,null);};W.InstallHashInto=function(cD,cE,cF){function cG(cJ){return Q.Parse(cF,be.FromHash(cJ,{$:1,$0:true}));}function cH(){return W.getCurrentHash(cG,cE);}function cI(cJ){if(!M.Equals(cD.Get(),cJ))cD.Set(cJ);}cI(cH());self.addEventListener("popstate",function(){return cI(cH());},false);self.addEventListener("hashchange",function(){return cI(cH());},false);self.document.body.addEventListener("click",function(cJ){var cK,cL,cM;cK=(cL=W.findLinkHref(cJ.target),cL==null?null:(cM=cL.$0,bL.StartsWith(cM,"#")?cG(cM):null));return cK==null?null:(cI(cK.$0),cJ.preventDefault());},false);Y.Sink(function(cJ){var cK;if(!M.Equals(cJ,cH())){cK=Q.HashLink(cF,cJ);self.history.pushState(null,null,cK);}},cD.get_View());};W.getCurrentHash=function(cD,cE){var cF,cG;cF=self.location.hash;cG=cD(cF);return cG==null?((function(cH){return function(cI){return cH("Failed to parse route: "+bj.toSafe(cI));};}(function(cH){cu.log(cH);}))(cF),cE):cG.$0;};W.findLinkHref=function(cD){while(true)if(cD.tagName==="A")return z.ofObj(cD.getAttribute("href"));else if(cD===self.document.body)return null;else cD=cD.parentNode;};X=D.Var$1=cw.Class({},o,X);X.Lens=function(cD,cE,cF){var cG,cH,cI;cG=bv.Id();cH=Y.Map(cE,cD.get_View());cI=new E({Get:function(){return cE(cD.Get());},Set:function(cJ){return cD.Update(function(cK){return cF(cK,cJ);});},SetFinal:function(cJ){return this.Set(cJ);},Update:function(cJ){return cD.Update(function(cK){return cF(cK,cJ(cE(cK)));});},UpdateMaybe:function(cJ){return cD.UpdateMaybe(function(cK){var cL;cL=cJ(cE(cK));return cL==null?null:{$:1,$0:cF(cK,cL.$0)};});},get_View:function(){return cH;},get_Id:function(){return cG;}});E.New.call(cI);return cI;};X.Create$1=function(cD){return new bB.New(false,bC.New({$:2,$0:cD,$1:[]}),cD);};X.Set=function(cD,cE){cD.Set(cE);};Y=D.View=cw.Class({},null,Y);Z.GetFieldValues=function(cD){var cE,cF;cE=[];for(var cG in cD)cE.push(cD[cG]);return cE;};_0.get=function(cD,cE){_0.checkBounds(cD,cE);return cD[cE];};d.checkThis=function(cD){return M.Equals(cD,null)?e.InvalidOp("The initialization of an object or value resulted in an object or value being accessed recursively before it was fully initialized."):cD;};_0.checkBounds=function(cD,cE){if(cE<0||cE>=cD.length)e.FailWith("Index was outside the bounds of the array.");};_0.length=function(cD){return cD.dims===2?cD.length*cD.length:cD.length;};_0.set=function(cD,cE,cF){_0.checkBounds(cD,cE);cD[cE]=cF;};_0.iter=function(cD,cE){var cF,cG;for(cF=0,cG=cE.length-1;cF<=cG;cF++)cD(cE[cF]);};_0.map=function(cD,cE){var cF,cG,cH;cF=new a.Array(cE.length);for(cG=0,cH=cE.length-1;cG<=cH;cG++)cF[cG]=cD(cE[cG]);return cF;};_0.sortInPlace=function(cD){_0.mapInPlace(function(cE){return cE[0];},_0.mapiInPlace(function(cE,cF){return[cF,cE];},cD).sort(M.Compare));};_0.filter=function(cD,cE){var cF,cG,cH;cF=[];for(cG=0,cH=cE.length-1;cG<=cH;cG++)if(cD(cE[cG]))cF.push(cE[cG]);return cF;};_0.ofSeq=function(cD){var cE,cF;if(cD instanceof a.Array)return cD.slice();else if(cD instanceof bc)return _0.ofList(cD);else{cE=[];cF=T.Get(cD);try{while(cF.MoveNext())cE.push(cF.Current());return cE;}finally{if(typeof cF=="object"&&"Dispose"in cF)cF.Dispose();}}};_0.choose=function(cD,cE){var cF,cG,cH,cI;cF=[];for(cG=0,cH=cE.length-1;cG<=cH;cG++){cI=cD(cE[cG]);cI==null?void 0:cF.push(cI.$0);}return cF;};_0.ofList=function(cD){var cE,cF;cF=[];cE=cD;while(!(cE.$==0)){cF.push(S.head(cE));cE=S.tail(cE);}return cF;};_0.map2=function(cD,cE,cF){var cG,cH,cI;_0.checkLength(cE,cF);cG=new a.Array(cF.length);for(cH=0,cI=cF.length-1;cH<=cI;cH++)cG[cH]=cD(cE[cH],cF[cH]);return cG;};_0.forall=function(cD,cE){var cF,cG,cH,cI;cF=true;cG=0;cI=_0.length(cE);while(cF&&cG<cI)if(cD(cE[cG]))cG=cG+1;else cF=false;return cF;};_0.init=function(cD,cE){var cF,cG,cH;cD<0?e.FailWith("Negative size given."):null;cF=new a.Array(cD);for(cG=0,cH=cD-1;cG<=cH;cG++)cF[cG]=cE(cG);return cF;};_0.exists=function(cD,cE){var cF,cG,cH,cI;cF=false;cG=0;cI=_0.length(cE);while(!cF&&cG<cI)if(cD(cE[cG]))cF=true;else cG=cG+1;return cF;};_0.tryPick=function(cD,cE){var cF,cG,cH;cF=null;cG=0;while(cG<cE.length&&cF==null){cH=cD(cE[cG]);cH!=null&&cH.$==1?cF=cH:void 0;cG=cG+1;}return cF;};_0.tryFindIndex=function(cD,cE){var cF,cG;cF=null;cG=0;while(cG<cE.length&&cF==null){cD(cE[cG])?cF={$:1,$0:cG}:void 0;cG=cG+1;}return cF;};_0.checkLength=function(cD,cE){if(cD.length!==cE.length)e.FailWith("The arrays have different lengths.");};_0.foldBack=function(cD,cE,cF){var cG,cH,cI,cJ,cK;cG=cF;cI=cE.length;for(cJ=1,cK=cI;cJ<=cK;cJ++)cG=cD(cE[cI-cJ],cG);return cG;};_0.pick=function(cD,cE){var cF;cF=_0.tryPick(cD,cE);return cF==null?e.FailWith("KeyNotFoundException"):cF.$0;};_0.concat=function(cD){return a.Array.prototype.concat.apply([],_0.ofSeq(cD));};_0.create=function(cD,cE){var cF,cG,cH;cF=new a.Array(cD);for(cG=0,cH=cD-1;cG<=cH;cG++)cF[cG]=cE;return cF;};_4=v.Dictionary=cw.Class({set_Item:function(cD,cE){this.set(cD,cE);},ContainsKey:function(cD){var cE,cF;cE=this;cF=this.data[this.hash(cD)];return cF==null?false:_0.exists(function(cG){return cE.equals.apply(null,[(e.KeyValue(cG))[0],cD]);},cF);},TryGetValue:function(cD,cE){var cF,cG,cH;cF=this;cG=this.data[this.hash(cD)];return cG==null?false:(cH=_0.tryPick(function(cI){var cJ;cJ=e.KeyValue(cI);return cF.equals.apply(null,[cJ[0],cD])?{$:1,$0:cJ[1]}:null;},cG),cH!=null&&cH.$==1&&(cE.set(cH.$0),true));},Remove:function(cD){return this.remove(cD);},get_Keys:function(){return new bW.New(this);},set:function(cD,cE){var cF,cG,cH,cI;cF=this;cG=this.hash(cD);cH=this.data[cG];cH==null?(this.count=this.count+1,this.data[cG]=new a.Array({K:cD,V:cE})):(cI=_0.tryFindIndex(function(cJ){return cF.equals.apply(null,[(e.KeyValue(cJ))[0],cD]);},cH),cI==null?(this.count=this.count+1,cH.push({K:cD,V:cE})):cH[cI.$0]={K:cD,V:cE});},remove:function(cD){var cE,cF,cG,cH;cE=this;cF=this.hash(cD);cG=this.data[cF];return cG==null?false:(cH=_0.filter(function(cI){return!cE.equals.apply(null,[(e.KeyValue(cI))[0],cD]);},cG),_0.length(cH)<cG.length&&(this.count=this.count-1,this.data[cF]=cH,true));},get_Item:function(cD){return this.get(cD);},get:function(cD){var cE,cF;cE=this;cF=this.data[this.hash(cD)];return cF==null?bT.notPresent():_0.pick(function(cG){var cH;cH=e.KeyValue(cG);return cE.equals.apply(null,[cH[0],cD])?{$:1,$0:cH[1]}:null;},cF);},GetEnumerator:function(){return T.Get0(this);},GetEnumerator0:function(){return T.Get0(_0.concat(Z.GetFieldValues(this.data)));}},o,_4);_4.New$5=cw.Ctor(function(){_4.New$6.call(this,[],M.Equals,M.Hash);},_4);_4.New$6=cw.Ctor(function(cD,cE,cF){var cG,cH;o.New.call(this);this.equals=cE;this.hash=cF;this.count=0;this.data=[];cG=T.Get(cD);try{while(cG.MoveNext()){cH=cG.Current();this.set(cH.K,cH.V);}}finally{if(typeof cG=="object"&&"Dispose"in cG)cG.Dispose();}},_4);_5.Doc=function(){bz.$cctor();return bz.Doc;};_5.ChildrenArray=function(cD){var cE,cF,cG;cE=[];for(cF=0,cG=cD.childNodes.length-1;cF<=cG;cF++)cE.push(cD.childNodes[cF]);return cE;};_5.AddClass=function(cD,cE){var cF;cF=_5.getClass(cD);cF===""?_5.setClass(cD,cE):!_5.clsRE(cE).test(cF)?_5.setClass(cD,cF+" "+cE):void 0;};_5.RemoveClass=function(cD,cE){var cF;_5.setClass(cD,(cF=_5.clsRE(cE),_5.getClass(cD).replace(cF,function(cG,cH,cI){return cH===""||cI===""?"":" ";})));};_5.IterSelector=function(cD,cE,cF){var cG,cH,cI;cG=cD.querySelectorAll(cE);for(cH=0,cI=cG.length-1;cH<=cI;cH++)cF(cG[cH]);};_5.CreateElement=function(cD){return _5.Doc().createElement(cD);};_5.SetAttr=function(cD,cE,cF){cD.setAttribute(cE,cF);};_5.getClass=function(cD){return cD instanceof a.SVGElement?cD.getAttribute("class"):cD.className;};_5.setClass=function(cD,cE){if(cD instanceof a.SVGElement)cD.setAttribute("class",cE);else cD.className=cE;};_5.clsRE=function(cD){return new a.RegExp("(\\s+|^)"+cD+"(?:\\s+"+cD+")*(\\s+|$)","g");};_5.InsertAt=function(cD,cE,cF){var cG;if(!(cF.parentNode===cD&&cE===(cG=cF.nextSibling,M.Equals(cG,null)?null:cG)))cD.insertBefore(cF,cE);};_5.RemoveNode=function(cD,cE){if(cE.parentNode===cD)cD.removeChild(cE);};_5.CreateText=function(cD){return _5.Doc().createTextNode(cD);};_6=D.Elt=cw.Class({ToUpdater:function(){var cD,cE,cF;return new _7.New((cD=this.docNode$1,cD!=null&&cD.$==1?cw.DeleteEmptyFields({Els:[this.elt],Dirty:true,Holes:[],Attrs:[[this.elt,cD.$0.Attr]],Render:(cE=null,cE?cE.$0:void 0),El:(cF={$:1,$0:this.elt},cF?cF.$0:void 0)},["Render","El"]):cD!=null&&cD.$==6?cD.$0:e.FailWith("Invalid docNode in Elt")),this.updates$1,this.elt,this.rvUpdates,X.Create$1([]));}},I,_6);_6.New=function(cD,cE,cF){var cG,cH;cG=bA.CreateElemNode(cD,cE,cF.docNode);cH=bD.Create(cF.updates);return new _6.New$1({$:1,$0:cG},Y.Map2Unit(bQ.Updates(cG.Attr),cH.v),cD,cH);};_6.TreeNode=function(cD,cE){var cF,cG;function cH(cI){return cI[1];}cF=bD.Create(cE);return new _6.New$1({$:6,$0:cD},Y.Map2Unit((cG=_0.map(function(cI){return bQ.Updates(cH(cI));},cD.Attrs),b9.TreeReduce(Y.Const(),Y.Map2Unit,cG)),cF.v),_0.get(cD.Els,0),cF);};_6.New$1=cw.Ctor(function(cD,cE,cF,cG){I.New.call(this,cD,cE);this.docNode$1=cD;this.updates$1=cE;this.elt=cF;this.rvUpdates=cG;},_6);_7=G.EltUpdater=cw.Class({RemoveUpdated:function(cD){var cE,cF;function cG(cH){return cH!==cF;}cE=cD.docNode;cE!=null&&cE.$==1?(cF=cE.$0.ElKey,this.treeNode.Holes=_0.filter(function(cH){return cH.ElKey!==cF;},this.treeNode.Holes),this.holeUpdates.Set(_0.filter(function(cH){return cG(cH[0]);},this.holeUpdates.Get()))):e.FailWith("DocUpdater.RemoveUpdated expects a single element node");},AddUpdated:function(cD){var cE,cF,cG;cE=cD.docNode;cE!=null&&cE.$==1?(cF=cE.$0,this.treeNode.Holes=this.treeNode.Holes.concat([cF]),cG=this.holeUpdates.Get(),cG.push([cF.ElKey,cD.updates]),this.holeUpdates.Set(cG)):e.FailWith("DocUpdater.AddUpdated expects a single element node");}},_6,_7);_7.New=cw.Ctor(function(cD,cE,cF,cG,cH){var cI,cJ,cK,cL;function cM(cN){return cN[1];}_6.New$1.call(this,{$:6,$0:cD},Y.Map2Unit(cE,(cI=cH.get_View(),Y.BindInner((cJ=function(cN){return _0.map(cM,cN);},(cK=(cL=Y.Const(),function(cN){return b9.TreeReduce(cL,Y.Map2Unit,cN);}),function(cN){return cK(cJ(cN));})),cI))),cF,cG);this.treeNode=cD;this.holeUpdates=cH;this.origHoles=this.treeNode.Holes;},_7);_8.TryParseInt32=function(cD,cE){return _8.TryParse(cD,-2147483648,2147483647,cE);};_.New=function(cD,cE,cF){return{c:cD,v:cE,f:cF};};ba=$.attr=cw.Class({},o,ba);bb.Create=function(cD,cE,cF,cG){return bb.Reactive(a.id,cD,cE,cF,cG);};bb.Single=function(cD,cE,cF,cG){return bb.Reactive(a.ignore,function(cH,cI,cJ){return((function(){return cD;}(cH))(cI))(cJ);},cE,cF,cG);};bb.Reactive=function(cD,cE,cF,cG,cH){var cI;function cJ(cK,cL,cM,cN){var cO,cP,cQ,cR,cS;cO=cD(cK);cP=(cQ=null,[cI.TryGetValue(cO,{get:function(){return cQ;},set:function(cT){cQ=cT;}}),cQ]);return cP[0]?(X.Set(cP[1][0],cK),cP[1][1]):(cR=X.Create$1(cK),(cS=I.Element("div",[bF.Create("class","ws-page"),cF==null?bQ.EmptyAttr():bF.Concat(cF.$0),bs.Handler("transitionend",function(cT){return function(){return cL.RemoveIfNeeded(cT);};})],[cE(cO,cM,cN)]),(cI.set_Item(cO,[cR,cS]),cS)));}cI=new _4.New$5();return function(cK){return bb.New(cw.Curried(cJ,3,[cK]),cG==null?false:cG.$0,cH==null?false:cH.$0);};};bb.New=function(cD,cE,cF){return{Render:cD,KeepInDom:cE,UsesTransition:cF};};bc=S.T=cw.Class({GetEnumerator:function(){return new U.New(this,null,function(cD){var cE;cE=cD.s;return cE.$==0?false:(cD.c=cE.$0,cD.s=cE.$1,true);},void 0);},GetEnumerator0:function(){return T.Get(this);}},null,bc);bc.Empty=new bc({$:0});bd.Delay=function(cD){return function(cE){try{(cD(null))(cE);}catch(cF){cE.k({$:1,$0:cF});}};};bd.TryWith=function(cD,cE){return function(cF){cD(bG.New(function(cG){if(cG.$==0)cF.k({$:0,$0:cG.$0});else if(cG.$==1)try{(cE(cG.$0))(cF);}catch(cH){cF.k(cG);}else cF.k(cG);},cF.ct));};};bd.Bind=function(cD,cE){return bd.checkCancel(function(cF){cD(bG.New(function(cG){var cH;if(cG.$==0){cH=cG.$0;bd.scheduler().Fork(function(){try{(cE(cH))(cF);}catch(cI){cF.k({$:1,$0:cI});}});}else bd.scheduler().Fork(function(){cF.k(cG);});},cF.ct));});};bd.Zero=function(){bM.$cctor();return bM.Zero;};bd.Start=function(cD,cE){var cF,cG;cF=(cG=(bd.defCTS())[0],cE==null?cG:cE.$0);bd.scheduler().Fork(function(){if(!cF.c)cD(bG.New(function(cH){if(cH.$==1)bd.UncaughtAsyncError(cH.$0);},cF));});};bd.checkCancel=function(cD){return function(cE){if(cE.ct.c)bd.cancel(cE);else cD(cE);};};bd.FromContinuations=function(cD){return function(cE){var cF;function cG(cH){if(cF[0])e.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{cF[0]=true;bd.scheduler().Fork(cH);}}cF=[false];cD(function(cH){cG(function(){cE.k({$:0,$0:cH});});},function(cH){cG(function(){cE.k({$:1,$0:cH});});},function(cH){cG(function(){cE.k({$:2,$0:cH});});});};};bd.defCTS=function(){bM.$cctor();return bM.defCTS;};bd.UncaughtAsyncError=function(cD){cu.log("WebSharper: Uncaught asynchronous exception",cD);};bd.cancel=function(cD){cD.k({$:2,$0:new cg.New(cD.ct)});};bd.scheduler=function(){bM.$cctor();return bM.scheduler;};bd.Return=function(cD){return function(cE){cE.k({$:0,$0:cD});};};be=P.Route=cw.Class({ToLink:function(){return bK.WriteLink(this.Segments,this.QueryArgs);}},null,be);be.FromHash=function(cD,cE){var cF,cG;cF=cD.indexOf("#");return cF===-1?be.get_Empty():(cG=cD.substring(cF+1),cE!=null&&cE.$0?cG===""||cG==="/"?be.get_Empty():bL.StartsWith(cG,"/")?be.FromUrl(cG.substring(1),{$:1,$0:true}):be.Segment$2(cG):be.FromUrl(cD.substring(cF),{$:1,$0:false}));};be.Combine=function(cD){var cE,cF,cG,cH,cI,cJ,cK;cE=_0.ofSeq(cD);cF=_0.length(cE);return cF===0?be.get_Empty():cF===1?_0.get(cE,0):(cG=null,cH=null,cI=[],cJ=new w.New([]),cK=new w.New([]),_0.iter(function(cL){var cM,cN;cM=cL.Method;cM!=null&&cM.$==1?cG=cM:void 0;cN=cL.Body.f();cN===null?void 0:cH=cN;cJ=y.FoldBack(function(cO,cP,cQ){return cQ.Add(cO,cP);},cJ,cL.QueryArgs);cK=y.FoldBack(function(cO,cP,cQ){return cQ.Add(cO,cP);},cK,cL.FormData);S.iter(function(cO){cI.push(cO);},cL.Segments);},cE),be.New(S.ofSeq(cI),cJ,cK,cG,N.CreateFromValue(cH)));};be.get_Empty=function(){return be.New(bc.Empty,new w.New([]),new w.New([]),null,N.CreateFromValue(null));};be.FromUrl=function(cD,cE){var cF,cG,cH;cF=(cG=cD.indexOf("?"),cG===-1?[cD,new w.New([])]:[bL.Substring(cD,0,cG),be.ParseQuery(cD.substring(cG+1))]);cH=be.get_Empty();return be.New(S.ofArray(bL.SplitChars(cF[0],["/"],cE!=null&&cE.$0?0:1)),cF[1],cH.FormData,cH.Method,cH.Body);};be.Segment$2=function(cD){var cE;cE=be.get_Empty();return be.New(S.ofArray([cD]),cE.QueryArgs,cE.FormData,cE.Method,cE.Body);};be.Segment=function(cD,cE){var cF;cF=be.get_Empty();return be.New(cD,cF.QueryArgs,cF.FormData,cE,cF.Body);};be.ParseQuery=function(cD){return y.OfArray(_0.ofSeq(_0.choose(function(cE){var cF,cG;cF=bL.SplitChars(cE,["="],0);return!M.Equals(cF,null)&&cF.length===2?(cG=_0.get(cF,1),{$:1,$0:[_0.get(cF,0),cG]}):((function(cH){return function(cI){return cH("wrong format for query argument: "+bj.toSafe(cI));};}(function(cH){cu.log(cH);}))(cE),null);},bL.SplitChars(cD,["&"],0))));};be.New=function(cD,cE,cF,cG,cH){return new be({Segments:cD,QueryArgs:cE,FormData:cF,Method:cG,Body:cH});};bf.$cctor=function(){bf.$cctor=a.ignore;bf.BaseUrl="https://peopleapi.websharper.com";bf.route=m.r$1();};bh.New=function(cD,cE,cF,cG,cH){return{Node:cD,Left:cE,Right:cF,Height:cG,Count:cH};};bi=v.Pair=cw.Class({Equals:function(cD){return M.Equals(this.Key,cD.Key);},GetHashCode:function(){return M.Hash(this.Key);},CompareTo0:function(cD){return M.Compare(this.Key,cD.Key);}},null,bi);bi.New=function(cD,cE){return new bi({Key:cD,Value:cE});};bg.TryFind=function(cD,cE){var cF;cF=(bg.Lookup(cD,cE))[0];return cF==null?null:{$:1,$0:cF.Node};};bg.Build=function(cD,cE,cF){var cG,cH,cI;return cF-cE+1<=0?null:(cG=(cE+cF)/2>>0,(cH=bg.Build(cD,cE,cG-1),(cI=bg.Build(cD,cG+1,cF),bg.Branch(_0.get(cD,cG),cH,cI))));};bg.Lookup=function(cD,cE){var cF,cG,cH,cI;cF=[];cG=cE;cH=true;while(cH)if(cG==null)cH=false;else{cI=M.Compare(cD,cG.Node);cI===0?cH=false:cI===1?(cF.unshift([true,cG.Node,cG.Left]),cG=cG.Right):(cF.unshift([false,cG.Node,cG.Right]),cG=cG.Left);}return[cG,cF];};bg.Branch=function(cD,cE,cF){var cG,cH;return bh.New(cD,cE,cF,1+(cG=cE==null?0:cE.Height,(cH=cF==null?0:cF.Height,M.Compare(cG,cH)===1?cG:cH)),1+(cE==null?0:cE.Count)+(cF==null?0:cF.Count));};bg.Enumerate=function(cD,cE){function cF(cG,cH){var cI;while(true)if(cG==null)return cH.$==1?{$:1,$0:[cH.$0[0],[cH.$0[1],cH.$1]]}:null;else if(cD){cI=cG;cG=cI.Right;cH=new bc({$:1,$0:[cI.Node,cI.Left],$1:cH});}else{cI=cG;cG=cI.Left;cH=new bc({$:1,$0:[cI.Node,cI.Right],$1:cH});}}return x.unfold(function(cG){return cF(cG[0],cG[1]);},[cE,bc.Empty]);};bg.Add=function(cD,cE){return bg.Put(function(cF,cG){return cG;},cD,cE);};bg.Put=function(cD,cE,cF){var cG,cH;cG=bg.Lookup(cE,cF);cH=cG[0];return cH==null?bg.Rebuild(cG[1],bg.Branch(cE,null,null)):bg.Rebuild(cG[1],bg.Branch(cD(cH.Node,cE),cH.Left,cH.Right));};bg.OfSeq=function(cD){var cE;cE=_0.ofSeq(x.distinct(cD));_0.sortInPlace(cE);return bg.Build(cE,0,cE.length-1);};bg.Rebuild=function(cD,cE){var cF,cH,cI,cJ,cK,cL,cM,cN,cO,cP;function cG(cQ){return cQ==null?0:cQ.Height;}cF=cE;for(cH=0,cI=_0.length(cD)-1;cH<=cI;cH++){cF=(cJ=_0.get(cD,cH),cJ[0]?(cK=cJ[1],(cL=cJ[2],cG(cF)>cG(cL)+1?cG(cF.Left)===cG(cF.Right)+1?(cM=cF.Left,bg.Branch(cM.Node,bg.Branch(cK,cL,cM.Left),bg.Branch(cF.Node,cM.Right,cF.Right))):bg.Branch(cF.Node,bg.Branch(cK,cL,cF.Left),cF.Right):bg.Branch(cK,cL,cF))):(cN=cJ[1],(cO=cJ[2],cG(cF)>cG(cO)+1?cG(cF.Right)===cG(cF.Left)+1?(cP=cF.Right,bg.Branch(cP.Node,bg.Branch(cF.Node,cF.Left,cP.Left),bg.Branch(cN,cP.Right,cO))):bg.Branch(cF.Node,cF.Left,bg.Branch(cN,cF.Right,cO)):bg.Branch(cN,cF,cO))));}return cF;};bj.padNumLeft=function(cD,cE){var cF;cF=_0.get(cD,0);return cF===" "||cF==="+"||cF==="-"?cF+bL.PadLeftWith(cD.substr(1),cE-1,"0"):bL.PadLeftWith(cD,cE,"0");};bj.toSafe=function(cD){return cD==null?"":cD;};bk.EditForm=function(cD,cE,cF){var cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW;function cX(cY){var cZ;function c0(c1){return{$:1,$0:c1};}cZ=function(c1){return cD(c0(c1));};return function(c1){return cZ(cY(c1));};}return(cG=(cH=(cI=bk.DisabledWhenRefreshing(cE),(cJ=(cK=bs.DynamicProp("disabled",Y.Map(function(cY){return!cY.Editing.HasDied;},cE)),(cL=Y.Map(function(cY){return cY.Editing.HasDied;},cE),(cM=cX(function(cY){return{$:4,$0:cY};}),(cN=Y.Map(function(cY){return cY.Editing.Died;},cE),(cO=cX(function(cY){return{$:3,$0:cY};}),(cP=Y.Map(function(cY){return cY.Editing.Born;},cE),(cQ=cX(function(cY){return{$:2,$0:cY};}),(cR=Y.Map(function(cY){return cY.Editing.LastName;},cE),(cS=cX(function(cY){return{$:1,$0:cY};}),(cT=Y.Map(function(cY){return cY.Editing.FirstName;},cE),(cU=cX(function(cY){return{$:0,$0:cY};}),bq.Make$1().WithHole({$:8,$0:"firstname",$1:new b7.New(cT,cU)}))).WithHole({$:8,$0:"lastname",$1:new b7.New(cR,cS)}))).WithHole({$:8,$0:"born",$1:new b7.New(cP,cQ)}))).WithHole({$:8,$0:"died",$1:new b7.New(cN,cO)}))).WithHole({$:9,$0:"hasdied",$1:new b7.New(cL,cM)}))).WithHole({$:3,$0:"diedattr",$1:cK})),cJ.WithHole(br.EventQ2(cJ.k,"submit",function(){return cJ.i;},function(cY){cD(cF.SubmitMessage);cY.Event.preventDefault();}))).WithHole({$:1,$0:"submittext",$1:cF.SubmitText}).WithHole({$:3,$0:"submitattr",$1:cI})),cH.WithHole(br.EventQ2(cH.k,"back",function(){return cH.i;},function(){cD({$:0,$0:{$:0}});}))),(cV=br.CompleteHoles(cG.k,cG.h,[["firstname",0],["lastname",0],["born",0],["died",0],["hasdied",2]]),(cW=new bp.New(cV[1],n.form(cV[0])),(cG.i=cW,cW)))).get_Doc();};bk.DisabledWhenRefreshing=function(cD){return bF.Concat([bs.DynamicProp("disabled",Y.Map(function(cE){return cE.Refreshing;},cD)),bs.DynamicClassPred("is-loading",Y.Map(function(cE){return cE.Refreshing;},cD))]);};bl.New=function(cD,cE){return{SubmitText:cD,SubmitMessage:cE};};bp=bo.TemplateInstance=cw.Class({get_Doc:function(){return this.doc;}},o,bp);bp.New=cw.Ctor(function(cD,cE){o.New.call(this);this.doc=cE;this.allVars=cD.$==0?cD.$0:e.FailWith("Should not happen");},bp);bq=bo.ProviderBuilder=cw.Class({WithHole:function(cD){this.h.push(cD);return this;}},null,bq);bq.Make$1=function(){var cD;return bq.New(null,(cD=bP.NewGuid(),a.String(cD)),[],null);};bq.New=function(cD,cE,cF,cG){var cH;return new bq((cH={i:cD,k:cE,h:cF},(cw.SetOptional(cH,"s",cG),cH)));};Y.Map=function(cD,cE){return Y.CreateLazy(function(){return bC.Map(cD,cE());});};Y.Sink=function(cD,cE){function cF(){bC.WhenRun(cE(),cD,function(){bd.scheduler().Fork(cF);});}bd.scheduler().Fork(cF);};Y.CreateLazy=function(cD){var cE;cE={c:null,o:cD};return function(){var cF,cG;cF=cE.c;return cF===null?(cF=cE.o(),cE.c=cF,(cG=cF.s,cG!=null&&cG.$==0)?cE.o=null:bC.WhenObsoleteRun(cF,function(){cE.c=null;}),cF):cF;};};Y.Map2Unit=function(cD,cE){return Y.CreateLazy(function(){return bC.Map2Unit(cD(),cE());});};Y.BindInner=function(cD,cE){return Y.JoinInner(Y.Map(cD,cE));};Y.Const=function(cD){var cE;cE=bC.New({$:0,$0:cD});return function(){return cE;};};Y.TryGet=function(cD){return bC.TryGet(cD());};Y.MapSeqCachedViewBy=function(cD,cE,cF){var cG;cG=[new _4.New$5()];return Y.Map(function(cH){var cI,cJ,cK;cI=cG[0];cJ=new _4.New$5();cK=b9.mapInPlace(function(cL){var cM,cN,cO;cM=cD(cL);cN=cI.ContainsKey(cM)?(cO=cI.get_Item(cM),(X.Set(cO.r,cL),cO)):Y.ConvertSeqNode(function(cP){return cE(cM,cP);},cL);cJ.set_Item(cM,cN);return cN.e;},_0.ofSeq(cH));cG[0]=cJ;return cK;},cF);};Y.JoinInner=function(cD){return Y.CreateLazy(function(){return bC.JoinInner(cD());});};Y.ConvertSeqNode=function(cD,cE){var cF,cG;cF=X.Create$1(cE);cG=cF.get_View();return{e:cD(cG),r:cF,w:cG};};Y.Get=function(cD,cE){var cF;function cG(){bC.WhenRun(cE(),function(cH){if(!cF[0]){cF[0]=true;cD(cH);}},function(){if(!cF[0])cG();});}cF=[false];cG();};Y.Bind=function(cD,cE){return Y.Join(Y.Map(cD,cE));};Y.Map3=function(cD,cE,cF,cG){return Y.CreateLazy(function(){return bC.Map3(cD,cE(),cF(),cG());});};Y.Sequence=function(cD){return Y.CreateLazy(function(){return bC.Sequence(x.map(function(cE){return cE();},cD));});};Y.Map2=function(cD,cE,cF){return Y.CreateLazy(function(){return bC.Map2(cD,cE(),cF());});};Y.Join=function(cD){return Y.CreateLazy(function(){return bC.Join(cD());});};br.EventQ2=function(cD,cE,cF,cG){return{$:5,$0:cE,$1:true,$2:function(cH){return function(cI){return cG({Vars:cF(),Target:cH,Event:cI});};}};};br.CompleteHoles=function(cD,cE,cF){var cH,cI,cJ,cK,cL,cM;function cG(cN,cO){var cP,cQ,cR,cS;return cI.Contains(cN)?null:(cP=cO===0?(cQ=X.Create$1(""),[{$:8,$0:cN,$1:cQ},cQ]):cO===1?(cR=X.Create$1(0),[{$:13,$0:cN,$1:cR},cR]):cO===2?(cS=X.Create$1(false),[{$:9,$0:cN,$1:cS},cS]):e.FailWith("Invalid value type"),(cH.set_Item(cN,cP[1]),{$:1,$0:cP[0]}));}cH=new _4.New$5();cI=new by.New$3();cJ=T.Get(cE);try{while(cJ.MoveNext()){cK=cJ.Current();(cK.$==8?(cL=[cK.$0,bR.Box(cK.$1)],true):cK.$==11?(cL=[cK.$0,bR.Box(cK.$1)],true):cK.$==10?(cL=[cK.$0,bR.Box(cK.$1)],true):cK.$==13?(cL=[cK.$0,bR.Box(cK.$1)],true):cK.$==12?(cL=[cK.$0,bR.Box(cK.$1)],true):cK.$==9&&(cL=[cK.$0,bR.Box(cK.$1)],true))?(cM=cL[0],cI.Add(cM),cH.set_Item(cM,cL[1])):void 0;}}finally{if(typeof cJ=="object"&&"Dispose"in cJ)cJ.Dispose();}return[x.append(cE,_0.choose(function(cN){return cG(cN[0],cN[1]);},cF)),{$:0,$0:cH}];};bs.ClassPred=function(cD,cE){return bQ.Static(function(cF){if(cE)_5.AddClass(cF,cD);else _5.RemoveClass(cF,cD);});};bs.DynamicClassPred=function(cD,cE){return bQ.Dynamic(cE,function(cF){return function(cG){return cG?_5.AddClass(cF,cD):_5.RemoveClass(cF,cD);};});};bs.DynamicCustom=function(cD,cE){return bQ.Dynamic(cE,cD);};bs.DynamicProp=function(cD,cE){return bQ.Dynamic(cE,function(cF){return function(cG){cF[cD]=cG;};});};bs.Handler=function(cD,cE){return bQ.Static(function(cF){cF.addEventListener(cD,function(cG){return(cE(cF))(cG);},false);});};bs.OnAfterRender=function(cD){return new bF({$:4,$0:cD});};bs.Value=function(cD){function cE(cF){return{$:1,$0:cF};}return bs.CustomValue(cD,a.id,function(cF){return cE(a.id(cF));});};bs.Checked=function(cD){function cE(cF,cG){return!M.Equals(cD.Get(),cF.checked)?cD.Set(cF.checked):null;}return bF.Concat([bs.DynamicProp("checked",cD.get_View()),bs.Handler("change",function(cF){return function(cG){return cE(cF,cG);};})]);};bs.IntValue=function(cD){return bs.CustomVar(cD,function(cE,cF){var cG;cG=cF.get_Input();return cE.value!==cG?void(cE.value=cG):null;},function(cE){var cF,cG,cH;cF=cE.value;return{$:1,$0:cr.isBlank(cF)?(cE.checkValidity?cE.checkValidity():true)?new b8({$:2,$0:cF}):new b8({$:1,$0:cF}):(cG=(cH=0,[_8.TryParseInt32(cF,{get:function(){return cH;},set:function(cI){cH=cI;}}),cH]),cG[0]?new b8({$:0,$0:cG[1],$1:cF}):new b8({$:1,$0:cF}))};});};bs.IntValueUnchecked=function(cD){return bs.CustomValue(cD,a.String,function(cE){var cF;return cr.isBlank(cE)?{$:1,$0:0}:(cF=+cE,cF!==cF>>0?null:{$:1,$0:cF});});};bs.FloatValue=function(cD){return bs.CustomVar(cD,function(cE,cF){var cG;cG=cF.get_Input();return cE.value!==cG?void(cE.value=cG):null;},function(cE){var cF,cG;cF=cE.value;return{$:1,$0:cr.isBlank(cF)?(cE.checkValidity?cE.checkValidity():true)?new b8({$:2,$0:cF}):new b8({$:1,$0:cF}):(cG=+cF,a.isNaN(cG)?new b8({$:1,$0:cF}):new b8({$:0,$0:cG,$1:cF}))};});};bs.FloatValueUnchecked=function(cD){return bs.CustomValue(cD,a.String,function(cE){var cF;return cr.isBlank(cE)?{$:1,$0:0}:(cF=+cE,a.isNaN(cF)?null:{$:1,$0:cF});});};bs.Dynamic=function(cD,cE){return bQ.Dynamic(cE,function(cF){return function(cG){return _5.SetAttr(cF,cD,cG);};});};bs.CustomValue=function(cD,cE,cF){return bs.CustomVar(cD,function(cG,cH){cG.value=cE(cH);},function(cG){return cF(cG.value);});};bs.CustomVar=function(cD,cE,cF){function cG(cI,cJ){return cD.UpdateMaybe(function(cK){var cL,cM;cL=cF(cI);return cL!=null&&cL.$==1&&(!M.Equals(cL.$0,cK)&&(cM=[cL,cL.$0],true))?cM[0]:null;});}function cH(cI,cJ){var cK,cL;cK=cF(cI);return cK!=null&&cK.$==1&&(M.Equals(cK.$0,cJ)&&(cL=cK.$0,true))?null:cE(cI,cJ);}return bF.Concat([bs.Handler("change",function(cI){return function(cJ){return cG(cI,cJ);};}),bs.Handler("input",function(cI){return function(cJ){return cG(cI,cJ);};}),bs.Handler("keypress",function(cI){return function(cJ){return cG(cI,cJ);};}),bs.DynamicCustom(function(cI){return function(cJ){return cH(cI,cJ);};},cD.get_View())]);};bv.Id=function(){bv.set_counter(bv.counter()+1);return"uid"+a.String(bv.counter());};bv.set_counter=function(cD){b$.$cctor();b$.counter=cD;};bv.counter=function(){b$.$cctor();return b$.counter;};bv.Int=function(){bv.set_counter(bv.counter()+1);return bv.counter();};bw.JSUnion=function(cD,cE){var cF;function cG(cK){var cL;function cM(cN){return cN!=null&&cN.$==1&&M.Equals(cK,cN.$0);}cL=x.tryFindIndex(function(cN){return cM(cN[0]);},cE);return cL!=null&&cL.$==1?cL.$0:cK.$;}function cH(cK,cL){return _0.init(_0.length((_0.get(cE,cK))[2]),function(cM){return cL["$"+a.String(cM)];});}function cI(cK,cL){var cM,cN,cO;cM=cD==null?{}:new cD();cN=_0.get(cE,cK);return(cO=cN[0],cO!=null&&cO.$==1)?cN[0].$0:(cM.$=cK,x.iteri(function(cP,cQ){cM["$"+a.String(cP)]=cQ;},cL),cM);}function cJ(cK,cL){var cM;function cN(cO,cP){return[cK,cO,cP,cM];}cM=cL[2];return x.map(function(cO){return cN(cO[0],cO[1]);},cL[1]);}cF=x.collect(function(cK){return cJ(cK[0],cK[1]);},x.indexed(cE));return bJ.New$1(function(cK){function cL(cM,cN,cO,cP){var cQ,cR,cS;function cT(cU,cV,cW){var cX;function cY(cZ,c0){return cT(cX,cZ,new bc({$:1,$0:c0,$1:cW}));}return cU.$==1?(cX=cU.$1,x.collect(function(cZ){return cY(cZ[0],cZ[1]);},cU.$0.Parse(cV))):[[cV,cI(cM,_0.ofList(S.rev(cW)))]];}return bw.isCorrectMethod(cN,cK.Method)?(cQ=bS.startsWith(S.ofArray(cO),cK.Segments),cQ==null?[]:(cR=cQ.$0,(cS=S.ofArray(cP),cS.$==0?[[be.New(cR,cK.QueryArgs,cK.FormData,cK.Method,cK.Body),cI(cM,[])]]:cT(cS,be.New(cR,cK.QueryArgs,cK.FormData,cK.Method,cK.Body),bc.Empty)))):[];}return x.collect(function(cM){return cL(cM[0],cM[1],cM[2],cM[3]);},cF);},function(cK){var cL,cM,cN,cO,cP,cQ;function cR(cS,cT){return cT.Write(cS);}cL=cG(cK);cM=_0.get(cE,cL);cN=cM[2];cO=_0.get(cM[1],0);cP=[be.Segment(S.ofArray(cO[1]),cO[0])];return!M.Equals(cN,null)&&cN.length===0?{$:1,$0:cP}:(cQ=(((cw.Curried3(_0.map2))(cR))(cH(cL,cK)))(cN),_0.forall(function(cS){return cS!=null;},cQ)?{$:1,$0:x.append(cP,x.collect(function(cS){return cS.$0;},cQ))}:null);});};bw.isCorrectMethod=function(cD,cE){return cE!=null&&cE.$==1?cD!=null&&cD.$==1?M.Equals(cE.$0,cD.$0):true:!(cD!=null&&cD.$==1);};bw.rInt=function(){ca.$cctor();return ca.rInt;};bw.rCors=function(cD){return bJ.New$1(function(cE){function cF(cG,cH){var cI,cJ;return[cG,cw.DeleteEmptyFields({DefaultAllows:(cI=null,cI?cI.$0:void 0),EndPoint:(cJ={$:1,$0:cH},cJ?cJ.$0:void 0)},["DefaultAllows","EndPoint"])];}return x.map(function(cG){return cF(cG[0],cG[1]);},cD.Parse(cE));},function(cE){var cF,cG;cF=(cG=cw.GetOptional(cE.EndPoint),cG==null?{$:1,$0:null}:{$:0,$0:cG.$0});return cF.$==1?{$:1,$0:[be.get_Empty()]}:cD.Write(cF.$0);});};bx.$cctor=function(){bx.$cctor=a.ignore;bx.LoadedTemplates=new _4.New$5();bx.LocalTemplatesLoaded=false;bx.TextHoleRE="\\${([^}]+)}";};by=v.HashSet=cw.Class({Add:function(cD){return this.add(cD);},Contains:function(cD){var cE;cE=this.data[this.hash(cD)];return cE==null?false:this.arrContains(cD,cE);},add:function(cD){var cE,cF;cE=this.hash(cD);cF=this.data[cE];return cF==null?(this.data[cE]=[cD],this.count=this.count+1,true):this.arrContains(cD,cF)?false:(cF.push(cD),this.count=this.count+1,true);},arrContains:function(cD,cE){var cF,cG,cH,cI;cF=true;cG=0;cI=cE.length;while(cF&&cG<cI)if(this.equals.apply(null,[cE[cG],cD]))cF=false;else cG=cG+1;return!cF;},ExceptWith:function(cD){var cE;cE=T.Get(cD);try{while(cE.MoveNext())this.Remove(cE.Current());}finally{if(typeof cE=="object"&&"Dispose"in cE)cE.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(cD){var cE,cF,cG,cH;cE=0;cF=cl.concat(this.data);for(cG=0,cH=cF.length-1;cG<=cH;cG++)_0.set(cD,cG,cF[cG]);},IntersectWith:function(cD){var cE,cF,cG,cH,cI;cE=new by.New$4(cD,this.equals,this.hash);cF=cl.concat(this.data);for(cG=0,cH=cF.length-1;cG<=cH;cG++){cI=cF[cG];!cE.Contains(cI)?this.Remove(cI):void 0;}},Remove:function(cD){var cE;cE=this.data[this.hash(cD)];return cE==null?false:this.arrRemove(cD,cE)&&(this.count=this.count-1,true);},arrRemove:function(cD,cE){var cF,cG,cH,cI;cF=true;cG=0;cI=cE.length;while(cF&&cG<cI)if(this.equals.apply(null,[cE[cG],cD])){cE.splice.apply(cE,[cG,1]);cF=false;}else cG=cG+1;return!cF;},GetEnumerator:function(){return T.Get(cl.concat(this.data));},GetEnumerator0:function(){return T.Get(cl.concat(this.data));}},o,by);by.New$3=cw.Ctor(function(){by.New$4.call(this,[],M.Equals,M.Hash);},by);by.New$4=cw.Ctor(function(cD,cE,cF){var cG;o.New.call(this);this.equals=cE;this.hash=cF;this.data=[];this.count=0;cG=T.Get(cD);try{while(cG.MoveNext())this.add(cG.Current());}finally{if(typeof cG=="object"&&"Dispose"in cG)cG.Dispose();}},by);by.New$2=cw.Ctor(function(cD){by.New$4.call(this,cD,M.Equals,M.Hash);},by);bz.$cctor=function(){bz.$cctor=a.ignore;bz.Doc=self.document;};bA.LinkElement=function(cD,cE){bA.InsertDoc(cD,cE,null);};bA.InsertDoc=function(cD,cE,cF){var cG;return cE!=null&&cE.$==1?bA.InsertNode(cD,cE.$0.El,cF):cE!=null&&cE.$==2?(cG=cE.$0,(cG.Dirty=false,bA.InsertDoc(cD,cG.Current,cF))):cE==null?cF:cE!=null&&cE.$==4?bA.InsertNode(cD,cE.$0.Text,cF):cE!=null&&cE.$==5?bA.InsertNode(cD,cE.$0,cF):cE!=null&&cE.$==6?_0.foldBack(function(cH,cI){return cH==null||cH.constructor===_1?bA.InsertDoc(cD,cH,cI):bA.InsertNode(cD,cH,cI);},cE.$0.Els,cF):bA.InsertDoc(cD,cE.$0,bA.InsertDoc(cD,cE.$1,cF));};bA.CreateRunState=function(cD,cE){return cc.New(cd.get_Empty(),bA.CreateElemNode(cD,bQ.EmptyAttr(),cE));};bA.PerformAnimatedUpdate=function(cD,cE,cF){var cG;return bY.get_UseAnimations()?(cG=null,bd.Delay(function(){var cH,cI,cJ;cH=cd.FindAll(cF);cI=bA.ComputeChangeAnim(cE,cH);cJ=bA.ComputeEnterAnim(cE,cH);return bd.Bind(bY.Play(bY.Append(cI,bA.ComputeExitAnim(cE,cH))),function(){return bd.Bind(bA.SyncElemNodesNextFrame(cD,cE),function(){return bd.Bind(bY.Play(cJ),function(){cE.PreviousNodes=cH;return bd.Return(null);});});});})):bA.SyncElemNodesNextFrame(cD,cE);};bA.PerformSyncUpdate=function(cD,cE,cF){var cG;cG=cd.FindAll(cF);bA.SyncElemNode(cD,cE.Top);cE.PreviousNodes=cG;};bA.InsertNode=function(cD,cE,cF){_5.InsertAt(cD,cF,cE);return cE;};bA.CreateElemNode=function(cD,cE,cF){var cG;bA.LinkElement(cD,cF);cG=bQ.Insert(cD,cE);return bE.New(cG,cF,null,cD,bv.Int(),cw.GetOptional(cG.OnAfterRender));};bA.SyncElemNodesNextFrame=function(cD,cE){function cF(cG){a.requestAnimationFrame(function(){bA.SyncElemNode(cD,cE.Top);cG();});}return bZ.BatchUpdatesEnabled()?bd.FromContinuations(function(cG,cH,cI){return cF.apply(null,[cG,cH,cI]);}):(bA.SyncElemNode(cD,cE.Top),bd.Return(null));};bA.ComputeExitAnim=function(cD,cE){return bY.Concat(_0.map(function(cF){return bQ.GetExitAnim(cF.Attr);},cd.ToArray(cd.Except(cE,cd.Filter(function(cF){return bQ.HasExitAnim(cF.Attr);},cD.PreviousNodes)))));};bA.ComputeEnterAnim=function(cD,cE){return bY.Concat(_0.map(function(cF){return bQ.GetEnterAnim(cF.Attr);},cd.ToArray(cd.Except(cD.PreviousNodes,cd.Filter(function(cF){return bQ.HasEnterAnim(cF.Attr);},cE)))));};bA.ComputeChangeAnim=function(cD,cE){var cF;function cG(cH){return bQ.HasChangeAnim(cH.Attr);}cF=function(cH){return cd.Filter(cG,cH);};return bY.Concat(_0.map(function(cH){return bQ.GetChangeAnim(cH.Attr);},cd.ToArray(cd.Intersect(cF(cD.PreviousNodes),cF(cE)))));};bA.SyncElemNode=function(cD,cE){!cD?bA.SyncElement(cE):void 0;bA.Sync(cE.Children);bA.AfterRender(cE);};bA.SyncElement=function(cD){function cE(cF){function cG(cH){var cI,cJ;return cH!=null&&cH.$==0?cG(cH.$0)||cG(cH.$1):cH!=null&&cH.$==2?(cI=cH.$0,cI.Dirty||cG(cI.Current)):cH!=null&&cH.$==6&&(cJ=cH.$0,cJ.Dirty||_0.exists(cE,cJ.Holes));}return cG(cF.Children);}bQ.Sync(cD.El,cD.Attr);cE(cD)?bA.DoSyncElement(cD):void 0;};bA.Sync=function(cD){var cE,cF;if(cD!=null&&cD.$==1)bA.SyncElemNode(false,cD.$0);else if(cD!=null&&cD.$==2)bA.Sync(cD.$0.Current);else if(cD==null);else if(cD!=null&&cD.$==5);else if(cD!=null&&cD.$==4){cE=cD.$0;cE.Dirty?(cE.Text.nodeValue=cE.Value,cE.Dirty=false):void 0;}else if(cD!=null&&cD.$==6){cF=cD.$0;_0.iter(function(cG){bA.SyncElemNode(false,cG);},cF.Holes);_0.iter(function(cG){bQ.Sync(cG[0],cG[1]);},cF.Attrs);bA.AfterRender(cF);}else{bA.Sync(cD.$0);bA.Sync(cD.$1);}};bA.AfterRender=function(cD){var cE;cE=cw.GetOptional(cD.Render);cE!=null&&cE.$==1?(cE.$0(cD.El),cw.SetOptional(cD,"Render",null)):void 0;};bA.DoSyncElement=function(cD){var cE,cF,cG;function cH(cI,cJ){var cK,cL;return cI!=null&&cI.$==1?cI.$0.El:cI!=null&&cI.$==2?(cK=cI.$0,cK.Dirty?(cK.Dirty=false,bA.InsertDoc(cE,cK.Current,cJ)):cH(cK.Current,cJ)):cI==null?cJ:cI!=null&&cI.$==4?cI.$0.Text:cI!=null&&cI.$==5?cI.$0:cI!=null&&cI.$==6?(cL=cI.$0,(cL.Dirty?cL.Dirty=false:void 0,_0.foldBack(function(cM,cN){return cM==null||cM.constructor===_1?cH(cM,cN):cM;},cL.Els,cJ))):cH(cI.$0,cH(cI.$1,cJ));}cE=cD.El;cq.Iter((cF=cD.El,function(cI){_5.RemoveNode(cF,cI);}),cq.Except(cq.DocChildren(cD),cq.Children(cD.El,cw.GetOptional(cD.Delimiters))));cH(cD.Children,(cG=cw.GetOptional(cD.Delimiters),cG!=null&&cG.$==1?cG.$0[1]:null));};bA.CreateEmbedNode=function(){return{Current:null,Dirty:false};};bA.UpdateEmbedNode=function(cD,cE){cD.Current=cE;cD.Dirty=true;};bA.InsertBeforeDelim=function(cD,cE){var cF,cG;cF=cD.parentNode;cG=self.document.createTextNode("");cF.insertBefore(cG,cD);bA.LinkPrevElement(cD,cE);return cG;};bA.CreateTextNode=function(){return{Text:_5.CreateText(""),Dirty:false,Value:""};};bA.UpdateTextNode=function(cD,cE){cD.Value=cE;cD.Dirty=true;};bA.LinkPrevElement=function(cD,cE){bA.InsertDoc(cD.parentNode,cE,cD);};bB=D.ConcreteVar=cw.Class({UpdateMaybe:function(cD){var cE;cE=cD(this.Get());cE!=null&&cE.$==1?this.Set(cE.$0):void 0;},Set:function(cD){if(this.isConst)(function(cE){return cE("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cE){cu.log(cE);}));else{bC.Obsolete(this.snap);this.current=cD;this.snap=bC.New({$:2,$0:cD,$1:[]});}},get_View:function(){return this.view;},Get:function(){return this.current;},Update:function(cD){this.Set(cD(this.Get()));}},E,bB);bB.New=cw.Ctor(function(cD,cE,cF){var cG;cG=this;E.New.call(this);this.isConst=cD;this.current=cF;this.snap=cE;this.view=function(){return cG.snap;};this.id=bv.Int();},bB);bC.Map=function(cD,cE){var cF,cG;cF=cE.s;return cF!=null&&cF.$==0?bC.New({$:0,$0:cD(cF.$0)}):(cG=bC.New({$:3,$0:[],$1:[]}),(bC.When(cE,function(cH){bC.MarkDone(cG,cE,cD(cH));},cG),cG));};bC.WhenRun=function(cD,cE,cF){var cG;cG=cD.s;cG==null?cF():cG!=null&&cG.$==2?(cG.$1.push(cF),cE(cG.$0)):cG!=null&&cG.$==3?(cG.$0.push(cE),cG.$1.push(cF)):cE(cG.$0);};bC.WhenObsoleteRun=function(cD,cE){var cF;cF=cD.s;cF==null?cE():cF!=null&&cF.$==2?cF.$1.push(cE):cF!=null&&cF.$==3?cF.$1.push(cE):void 0;};bC.When=function(cD,cE,cF){var cG;cG=cD.s;cG==null?bC.Obsolete(cF):cG!=null&&cG.$==2?(bC.EnqueueSafe(cG.$1,cF),cE(cG.$0)):cG!=null&&cG.$==3?(cG.$0.push(cE),bC.EnqueueSafe(cG.$1,cF)):cE(cG.$0);};bC.MarkDone=function(cD,cE,cF){var cG;if(cG=cE.s,cG!=null&&cG.$==0)bC.MarkForever(cD,cF);else bC.MarkReady(cD,cF);};bC.EnqueueSafe=function(cD,cE){var cF,cG,cH,cI;cD.push(cE);if(cD.length%20===0){cF=cD.slice(0);cp.Clear(cD);for(cG=0,cH=_0.length(cF)-1;cG<=cH;cG++){cI=_0.get(cF,cG);typeof cI=="object"?function(cJ){if(cJ.s)cD.push(cJ);}(cI):function(cJ){cD.push(cJ);}(cI);}}else void 0;};bC.MarkForever=function(cD,cE){var cF,cG,cH,cI;cF=cD.s;if(cF!=null&&cF.$==3){cD.s={$:0,$0:cE};cG=cF.$0;for(cH=0,cI=_0.length(cG)-1;cH<=cI;cH++)(_0.get(cG,cH))(cE);}else void 0;};bC.MarkReady=function(cD,cE){var cF,cG,cH,cI;cF=cD.s;if(cF!=null&&cF.$==3){cD.s={$:2,$0:cE,$1:cF.$1};cG=cF.$0;for(cH=0,cI=_0.length(cG)-1;cH<=cI;cH++)(_0.get(cG,cH))(cE);}else void 0;};bC.Map2Unit=function(cD,cE){var cF,cG,cH;function cI(){var cJ,cK,cL;if(!(cJ=cH.s,cJ!=null&&cJ.$==0||cJ!=null&&cJ.$==2)){cK=bC.ValueAndForever(cD);cL=bC.ValueAndForever(cE);cK!=null&&cK.$==1?cL!=null&&cL.$==1?cK.$0[1]&&cL.$0[1]?bC.MarkForever(cH,null):bC.MarkReady(cH,null):void 0:void 0;}}cF=cD.s;cG=cE.s;return cF!=null&&cF.$==0?cG!=null&&cG.$==0?bC.New({$:0,$0:null}):cE:cG!=null&&cG.$==0?cD:(cH=bC.New({$:3,$0:[],$1:[]}),(bC.When(cD,cI,cH),bC.When(cE,cI,cH),cH));};bC.TryGet=function(cD){var cE,cF;cE=cD.s;return(cE!=null&&cE.$==0?(cF=cE.$0,true):cE!=null&&cE.$==2&&(cF=cE.$0,true))?{$:1,$0:cF}:null;};bC.ValueAndForever=function(cD){var cE;cE=cD.s;return cE!=null&&cE.$==0?{$:1,$0:[cE.$0,true]}:cE!=null&&cE.$==2?{$:1,$0:[cE.$0,false]}:null;};bC.JoinInner=function(cD){var cE;cE=bC.New({$:3,$0:[],$1:[]});bC.When(cD,function(cF){var cG;cG=cF();bC.When(cG,function(cH){var cI,cJ;if((cI=cG.s,cI!=null&&cI.$==0)&&(cJ=cD.s,cJ!=null&&cJ.$==0))bC.MarkForever(cE,cH);else bC.MarkReady(cE,cH);},cE);bC.WhenObsolete(cD,cG);},cE);return cE;};bC.Copy=function(cD){var cE,cF,cG;cE=cD.s;return cE==null?cD:cE!=null&&cE.$==2?(cF=bC.New({$:2,$0:cE.$0,$1:[]}),(bC.WhenObsolete(cD,cF),cF)):cE!=null&&cE.$==3?(cG=bC.New({$:3,$0:[],$1:[]}),(bC.When(cD,function(cH){bC.MarkDone(cG,cD,cH);},cG),cG)):cD;};bC.WhenObsolete=function(cD,cE){var cF;cF=cD.s;cF==null?bC.Obsolete(cE):cF!=null&&cF.$==2?bC.EnqueueSafe(cF.$1,cE):cF!=null&&cF.$==3?bC.EnqueueSafe(cF.$1,cE):void 0;};bC.Map3=function(cD,cE,cF,cG){var cH,cI,cJ,cK;function cL(cM){var cN,cO,cP,cQ;if(!(cN=cK.s,cN!=null&&cN.$==0||cN!=null&&cN.$==2)){cO=bC.ValueAndForever(cE);cP=bC.ValueAndForever(cF);cQ=bC.ValueAndForever(cG);cO!=null&&cO.$==1?cP!=null&&cP.$==1?cQ!=null&&cQ.$==1?cO.$0[1]&&cP.$0[1]&&cQ.$0[1]?bC.MarkForever(cK,cD(cO.$0[0],cP.$0[0],cQ.$0[0])):bC.MarkReady(cK,cD(cO.$0[0],cP.$0[0],cQ.$0[0])):void 0:void 0:void 0;}}cH=cE.s;cI=cF.s;cJ=cG.s;return cH!=null&&cH.$==0?cI!=null&&cI.$==0?cJ!=null&&cJ.$==0?bC.New({$:0,$0:cD(cH.$0,cI.$0,cJ.$0)}):bC.Map3Opt1(cD,cH.$0,cI.$0,cG):cJ!=null&&cJ.$==0?bC.Map3Opt2(cD,cH.$0,cJ.$0,cF):bC.Map3Opt3(cD,cH.$0,cF,cG):cI!=null&&cI.$==0?cJ!=null&&cJ.$==0?bC.Map3Opt4(cD,cI.$0,cJ.$0,cE):bC.Map3Opt5(cD,cI.$0,cE,cG):cJ!=null&&cJ.$==0?bC.Map3Opt6(cD,cJ.$0,cE,cF):(cK=bC.New({$:3,$0:[],$1:[]}),(bC.When(cE,cL,cK),bC.When(cF,cL,cK),bC.When(cG,cL,cK),cK));};bC.Sequence=function(cD){var cE,cF,cG;function cH(cI){var cJ;if(cG[0]===0){cJ=_0.map(function(cK){var cL;cL=cK.s;return cL!=null&&cL.$==0?cL.$0:cL!=null&&cL.$==2?cL.$0:e.FailWith("value not found by View.Sequence");},cE);_0.forall(function(cK){var cL;cL=cK.s;return cL!=null&&cL.$==0;},cE)?bC.MarkForever(cF,cJ):bC.MarkReady(cF,cJ);}else cG[0]--;}cE=_0.ofSeq(cD);return cE.length==0?bC.New({$:0,$0:[]}):(cF=bC.New({$:3,$0:[],$1:[]}),(cG=[_0.length(cE)-1],(_0.iter(function(cI){bC.When(cI,cH,cF);},cE),cF)));};bC.Map2=function(cD,cE,cF){var cG,cH,cI;function cJ(cK){var cL,cM,cN;if(!(cL=cI.s,cL!=null&&cL.$==0||cL!=null&&cL.$==2)){cM=bC.ValueAndForever(cE);cN=bC.ValueAndForever(cF);cM!=null&&cM.$==1?cN!=null&&cN.$==1?cM.$0[1]&&cN.$0[1]?bC.MarkForever(cI,cD(cM.$0[0],cN.$0[0])):bC.MarkReady(cI,cD(cM.$0[0],cN.$0[0])):void 0:void 0;}}cG=cE.s;cH=cF.s;return cG!=null&&cG.$==0?cH!=null&&cH.$==0?bC.New({$:0,$0:cD(cG.$0,cH.$0)}):bC.Map2Opt1(cD,cG.$0,cF):cH!=null&&cH.$==0?bC.Map2Opt2(cD,cH.$0,cE):(cI=bC.New({$:3,$0:[],$1:[]}),(bC.When(cE,cJ,cI),bC.When(cF,cJ,cI),cI));};bC.Join=function(cD){var cE;cE=bC.New({$:3,$0:[],$1:[]});bC.When(cD,function(cF){var cG;cG=cF();bC.When(cG,function(cH){var cI,cJ;if((cI=cG.s,cI!=null&&cI.$==0)&&(cJ=cD.s,cJ!=null&&cJ.$==0))bC.MarkForever(cE,cH);else bC.MarkReady(cE,cH);},cE);},cE);return cE;};bC.Map3Opt1=function(cD,cE,cF,cG){return bC.Map(function(cH){return cD(cE,cF,cH);},cG);};bC.Map3Opt2=function(cD,cE,cF,cG){return bC.Map(function(cH){return cD(cE,cH,cF);},cG);};bC.Map3Opt3=function(cD,cE,cF,cG){return bC.Map2(function(cH,cI){return cD(cE,cH,cI);},cF,cG);};bC.Map3Opt4=function(cD,cE,cF,cG){return bC.Map(function(cH){return cD(cH,cE,cF);},cG);};bC.Map3Opt5=function(cD,cE,cF,cG){return bC.Map2(function(cH,cI){return cD(cH,cE,cI);},cF,cG);};bC.Map3Opt6=function(cD,cE,cF,cG){return bC.Map2(function(cH,cI){return cD(cH,cI,cE);},cF,cG);};bC.Map2Opt1=function(cD,cE,cF){return bC.Map(function(cG){return cD(cE,cG);},cF);};bC.Map2Opt2=function(cD,cE,cF){return bC.Map(function(cG){return cD(cG,cE);},cF);};bD=D.Updates=cw.Class({},null,bD);bD.Create=function(cD){var cE;cE=null;cE=bD.New(cD,null,function(){var cF;cF=cE.s;return cF===null?(cF=bC.Copy(cE.c()),cE.s=cF,bC.WhenObsoleteRun(cF,function(){cE.s=null;}),cF):cF;});return cE;};bD.New=function(cD,cE,cF){return new bD({c:cD,s:cE,v:cF});};bE=D.DocElemNode=cw.Class({Equals:function(cD){return this.ElKey===cD.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bE);bE.New=function(cD,cE,cF,cG,cH,cI){var cJ;return new bE((cJ={Attr:cD,Children:cE,El:cG,ElKey:cH},(cw.SetOptional(cJ,"Delimiters",cF),cw.SetOptional(cJ,"Render",cI),cJ)));};bF=D.AttrProxy=cw.Class({},null,bF);bF.Create=function(cD,cE){return bQ.Static(function(cF){_5.SetAttr(cF,cD,cE);});};bF.Concat=function(cD){var cE;cE=b9.ofSeqNonCopying(cD);return b9.TreeReduce(bQ.EmptyAttr(),bF.Append,cE);};bF.Append=function(cD,cE){return bQ.AppendTree(cD,cE);};bF.Handler=function(cD,cE){return bF.HandlerImpl(cD,cE);};bF.HandlerImpl=function(cD,cE){return bQ.Static(function(cF){cF.addEventListener(cD,function(cG){return(cE(cF))(cG);},false);});};bG.New=function(cD,cE){return{k:cD,ct:cE};};bI=J.NonStandardPromiseRejectionException=cw.Class({},bH,bI);bI.New=cw.Ctor(function(cD){this.message="Promise rejected";_1.setPrototypeOf(this,bI.prototype);this.reason=cD;},bI);bJ.New$1=function(cD,cE){return{Parse:cD,Write:cE};};bK.WriteLink=function(cD,cE){var cF;cF=cE.get_IsEmpty()?"":"?"+bK.WriteQuery(cE);return"/"+bK.Concat(cD)+cF;};bK.Concat=function(cD){var cE,cF;cE=[];cF=true;S.iter(function(cG){if(!bL.IsNullOrEmpty(cG)){cF?cF=false:cE.push("/");cE.push(cG);}},cD);return bL.Join("",_0.ofSeq(cE));};bK.WriteQuery=function(cD){function cE(cF,cG){return cF+"="+cG;}return bL.concat("&",x.map(function(cF){return cE(cF[0],cF[1]);},y.ToSeq(cD)));};bL.TrimEnd=function(cD,cE){var cF,cG;if(M.Equals(cE,null)||cE.length==0)return bL.TrimEndWS(cD);else{cF=cD.length-1;cG=true;while(cF>=0&&cG)(function(){var cH;cH=cD[cF];return _0.exists(function(cI){return cH===cI;},cE)?void(cF=cF-1):void(cG=false);}());return bL.Substring(cD,0,cF+1);}};bL.StartsWith=function(cD,cE){return cD.substring(0,cE.length)==cE;};bL.TrimEndWS=function(cD){return cD.replace(new a.RegExp("\\s+$"),"");};bL.PadLeftWith=function(cD,cE,cF){return cE>cD.length?a.Array(cE-cD.length+1).join(cF)+cD:cD;};bL.concat=function(cD,cE){return _0.ofSeq(cE).join(cD);};bL.SplitChars=function(cD,cE,cF){return bL.Split(cD,new a.RegExp("["+bL.RegexEscape(cE.join(""))+"]"),cF);};bL.Substring=function(cD,cE,cF){return cD.substr(cE,cF);};bL.Split=function(cD,cE,cF){return cF===1?_0.filter(function(cG){return cG!=="";},bL.SplitWith(cD,cE)):bL.SplitWith(cD,cE);};bL.RegexEscape=function(cD){return cD.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bL.IsNullOrEmpty=function(cD){return cD==null||cD=="";};bL.Join=function(cD,cE){return cE.join(cD);};bL.SplitWith=function(cD,cE){return cD.split(cE);};bL.forall=function(cD,cE){return x.forall(cD,bL.protect(cE));};bL.Trim=function(cD){return cD.replace(new a.RegExp("^\\s+"),"").replace(new a.RegExp("\\s+$"),"");};bL.protect=function(cD){return cD===null?"":cD;};bM.$cctor=function(){bM.$cctor=a.ignore;bM.noneCT=b1.New(false,[]);bM.scheduler=new b5.New();bM.defCTS=[new b6.New()];bM.Zero=bd.Return();bM.GetCT=function(cD){cD.k({$:0,$0:cD.ct});};};_0.mapiInPlace=function(cD,cE){var cF,cG;for(cF=0,cG=cE.length-1;cF<=cG;cF++)cE[cF]=cD(cF,cE[cF]);return cE;};_0.mapInPlace=function(cD,cE){var cF,cG;for(cF=0,cG=cE.length-1;cF<=cG;cF++)cE[cF]=cD(cE[cF]);};x.insufficient=function(){return e.FailWith("The input sequence has an insufficient number of elements.");};bN=v.List=cw.Class({GetEnumerator:function(){return T.Get(this);},GetEnumerator0:function(){return T.Get0(this);}},null,bN);bP.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(cD){var cE,cF;cE=cA.random()*16|0;cF=cD=="x"?cE:cE&3|8;return cF.toString(16);});};bP.TryParse=function(cD,cE){try{cE.set(bP.Parse(cD));return true;}catch(cF){return false;}};bP.Parse=function(cD){var cE,cF,cG;try{return bP.ParseExact(cD,"D");}catch(cH){try{cE=bP.ParseExact(cD,"B");}catch(cI){try{cF=bP.ParseExact(cD,"P");}catch(cJ){try{cG=bP.ParseExact(cD,"N");}catch(cK){cG=bP.ParseExact(cD,"X");}cF=cG;}cE=cF;}return cE;}};bP.ParseExact=function(cD,cE){var cF,cG,cH,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS;function cI(cT){var cU,cV,cW,cX;for(cU=0,cV=35;cU<=cV;cU++){cU===8||(cU===13||(cU===18||cU===23))?cT[cU]!=="-"?bP.ShapeError():void 0:(cX=cT[cU],!("0"<=cX&&cX<="9"||"a"<=cX&&cX<="f")?bP.ShapeError():void 0);}return cT;}cJ=cE.toUpperCase();if(cJ==="N"){cK=bL.Trim(cD).toLowerCase();if(cK.length!==32)bP.ShapeError();for(cL=0,cM=31;cL<=cM;cL++){cN=cK[cL];!("0"<=cN&&cN<="9"||"a"<=cN&&cN<="f")?bP.ShapeError():void 0;}return bL.Substring(cK,0,8)+"-"+bL.Substring(cK,8,4)+"-"+bL.Substring(cK,12,4)+"-"+bL.Substring(cK,16,4)+"-"+cK.substring(20);}else if(cJ==="D"){cF=bL.Trim(cD).toLowerCase();cF.length!==36?bP.ShapeError():void 0;return cI(cF);}else if(cJ==="B"){cG=bL.Trim(cD).toLowerCase();cG.length!==38||cG[0]!=="{"||cG[17]!=="}"?bP.ShapeError():void 0;return cI(bL.Substring(cG,1,36));}else if(cJ==="P"){cH=bL.Trim(cD).toLowerCase();cH.length!==38||cH[0]!=="("||cH[17]!==")"?bP.ShapeError():void 0;return cI(bL.Substring(cH,1,36));}else if(cJ==="X"){cO=bL.Trim(cD).toLowerCase();if(cO.length!==68)bP.ShapeError();for(cP=0,cQ=67;cP<=cQ;cP++){switch(cP){case 26:case 0:if(cO[cP]!=="{")bP.ShapeError();break;case 62:case 57:case 52:case 47:case 42:case 37:case 32:case 27:case 19:case 12:case 1:if(cO[cP]!=="0")bP.ShapeError();break;case 63:case 58:case 53:case 48:case 43:case 38:case 33:case 28:case 20:case 13:case 2:if(cO[cP]!=="x")bP.ShapeError();break;case 61:case 56:case 51:case 46:case 41:case 36:case 31:case 25:case 18:case 11:if(cO[cP]!==",")bP.ShapeError();break;case 67:case 66:if(cO[cP]!=="{")bP.ShapeError();break;default:cS=cO[cP];!("0"<=cS&&cS<="9"||"a"<=cS&&cS<="f")?bP.ShapeError():void 0;break;}}return bL.Substring(cO,3,8)+"-"+bL.Substring(cO,14,4)+"-"+bL.Substring(cO,21,4)+"-"+bL.Substring(cO,29,2)+bL.Substring(cO,34,2)+"-"+bL.Substring(cO,39,2)+bL.Substring(cO,44,2)+bL.Substring(cO,49,2)+bL.Substring(cO,54,2)+bL.Substring(cO,59,2)+bL.Substring(cO,64,2);}else return bP.FormatError();};bP.ShapeError=function(){throw new ct.New$1("Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");};bP.FormatError=function(){throw new ct.New$1("Format String can be only \"D\", \"d\", \"N\", \"n\", \"P\", \"p\", \"B\", \"b\", \"X\" or \"x\".");};bQ.Static=function(cD){return new bF({$:3,$0:cD});};bQ.Dynamic=function(cD,cE){return new bF({$:1,$0:new b_.New(cD,cE)});};bQ.EmptyAttr=function(){cm.$cctor();return cm.EmptyAttr;};bQ.AppendTree=function(cD,cE){var cF;return cD===null?cE:cE===null?cD:(cF=new bF({$:2,$0:cD,$1:cE}),(bQ.SetFlags(cF,bQ.Flags(cD)|bQ.Flags(cE)),cF));};bQ.Insert=function(cD,cE){var cF,cG,cH;function cI(cJ){if(!(cJ===null))if(cJ!=null&&cJ.$==1)cF.push(cJ.$0);else if(cJ!=null&&cJ.$==2){cI(cJ.$0);cI(cJ.$1);}else if(cJ!=null&&cJ.$==3)cJ.$0(cD);else if(cJ!=null&&cJ.$==4)cG.push(cJ.$0);}cF=[];cG=[];cI(cE);cH=cF.slice(0);return b3.New(cD,bQ.Flags(cE),cH,cG.length===0?null:{$:1,$0:function(cJ){x.iter(function(cK){cK(cJ);},cG);}});};bQ.HasExitAnim=function(cD){var cE;cE=2;return(cD.DynFlags&cE)===cE;};bQ.GetExitAnim=function(cD){return bQ.GetAnim(cD,function(cE,cF){return cE.NGetExitAnim(cF);});};bQ.HasEnterAnim=function(cD){var cE;cE=1;return(cD.DynFlags&cE)===cE;};bQ.GetEnterAnim=function(cD){return bQ.GetAnim(cD,function(cE,cF){return cE.NGetEnterAnim(cF);});};bQ.HasChangeAnim=function(cD){var cE;cE=4;return(cD.DynFlags&cE)===cE;};bQ.GetChangeAnim=function(cD){return bQ.GetAnim(cD,function(cE,cF){return cE.NGetChangeAnim(cF);});};bQ.Updates=function(cD){return b9.MapTreeReduce(function(cE){return cE.NChanged();},Y.Const(),Y.Map2Unit,cD.DynNodes);};bQ.SetFlags=function(cD,cE){cD.flags=cE;};bQ.Flags=function(cD){return cD!==null&&cD.hasOwnProperty("flags")?cD.flags:0;};bQ.GetAnim=function(cD,cE){return bY.Concat(_0.map(function(cF){return cE(cF,cD.DynElem);},cD.DynNodes));};bQ.Sync=function(cD,cE){_0.iter(function(cF){cF.NSync(cD);},cE.DynNodes);};bQ.Empty=function(cD){return b3.New(cD,0,[],null);};bR.Box=a.id;bS.startsWith=function(cD,cE){var cF;switch(cD.$==1?cE.$==1?M.Equals(cD.$0,cE.$0)?(cF=[cE.$0,cE.$1,cD.$0,cD.$1],1):2:2:0){case 0:return{$:1,$0:cE};case 1:return bS.startsWith(cF[3],cF[1]);case 2:return null;}};bT.notPresent=function(){return e.FailWith("The given key was not present in the dictionary.");};bU.convertTextNode=function(cD){var cE,cF,cG,cH,cI,cJ;cE=null;cF=0;cH=cD.textContent;cI=new a.RegExp(H.TextHoleRE(),"g");while(cE=cI.exec(cH),cE!==null){cD.parentNode.insertBefore(self.document.createTextNode(bV.string(cH,{$:1,$0:cF},{$:1,$0:cI.lastIndex-_0.get(cE,0).length-1})),cD);cF=cI.lastIndex;cJ=self.document.createElement("span");cJ.setAttribute("ws-replace",_0.get(cE,1).toLowerCase());cD.parentNode.insertBefore(cJ,cD);}cI.lastIndex=0;cD.textContent=bV.string(cH,{$:1,$0:cF},null);};bU.failNotLoaded=function(cD){cu.warn("Instantiating non-loaded template",cD);};bU.fillTextHole=function(cD,cE,cF){var cG;cG=cD.querySelector("[ws-replace]");return M.Equals(cG,null)?(cu.warn("Filling non-existent text hole",cF),null):(cG.parentNode.replaceChild(new a.Text(cE),cG),{$:1,$0:cG.getAttribute("ws-replace")});};bU.removeHolesExcept=function(cD,cE){function cF(cG){_5.IterSelector(cD,"["+cG+"]",function(cH){if(!cE.Contains(cH.getAttribute(cG)))cH.removeAttribute(cG);});}cF("ws-attr");cF("ws-onafterrender");cF("ws-var");_5.IterSelector(cD,"[ws-hole]",function(cG){if(!cE.Contains(cG.getAttribute("ws-hole"))){cG.removeAttribute("ws-hole");while(cG.hasChildNodes())cG.removeChild(cG.lastChild);}});_5.IterSelector(cD,"[ws-replace]",function(cG){if(!cE.Contains(cG.getAttribute("ws-replace")))cG.parentNode.removeChild(cG);});_5.IterSelector(cD,"[ws-on]",function(cG){cG.setAttribute("ws-on",bL.concat(" ",_0.filter(function(cH){return cE.Contains(_0.get(bL.SplitChars(cH,[":"],1),1));},bL.SplitChars(cG.getAttribute("ws-on"),[" "],1))));});_5.IterSelector(cD,"[ws-attr-holes]",function(cG){var cH,cI,cJ,cK,cL;cH=bL.SplitChars(cG.getAttribute("ws-attr-holes"),[" "],1);for(cI=0,cJ=cH.length-1;cI<=cJ;cI++){cK=_0.get(cH,cI);cG.setAttribute(cK,(cL=new a.RegExp(H.TextHoleRE(),"g"),cG.getAttribute(cK).replace(cL,function(cM,cN){return cE.Contains(cN)?cM:"";})));}});};bU.fillInstanceAttrs=function(cD,cE){var cF,cG,cH,cI,cJ;bU.convertAttrs(cE);cF=cE.nodeName.toLowerCase();cG=cD.querySelector("[ws-attr="+cF+"]");if(M.Equals(cG,null))cu.warn("Filling non-existent attr hole",cF);else{cG.removeAttribute("ws-attr");for(cH=0,cI=cE.attributes.length-1;cH<=cI;cH++){cJ=cE.attributes.item(cH);cJ.name==="class"&&cG.hasAttribute("class")?cG.setAttribute("class",cG.getAttribute("class")+" "+cJ.nodeValue):cG.setAttribute(cJ.name,cJ.nodeValue);}}};bU.mapHoles=function(cD,cE){function cF(cG){_5.IterSelector(cD,"["+cG+"]",function(cH){var cI,cJ;cI=(cJ=null,[cE.TryGetValue(cH.getAttribute(cG).toLowerCase(),{get:function(){return cJ;},set:function(cK){cJ=cK;}}),cJ]);cI[0]?cH.setAttribute(cG,cI[1]):void 0;});}cF("ws-hole");cF("ws-replace");cF("ws-attr");cF("ws-onafterrender");cF("ws-var");_5.IterSelector(cD,"[ws-on]",function(cG){cG.setAttribute("ws-on",bL.concat(" ",_0.map(function(cH){var cI,cJ,cK;cI=bL.SplitChars(cH,[":"],1);cJ=(cK=null,[cE.TryGetValue(_0.get(cI,1),{get:function(){return cK;},set:function(cL){cK=cL;}}),cK]);return cJ[0]?_0.get(cI,0)+":"+cJ[1]:cH;},bL.SplitChars(cG.getAttribute("ws-on"),[" "],1))));});_5.IterSelector(cD,"[ws-attr-holes]",function(cG){var cH,cI,cJ;cH=bL.SplitChars(cG.getAttribute("ws-attr-holes"),[" "],1);for(cI=0,cJ=cH.length-1;cI<=cJ;cI++)(function(){var cK;function cL(cM,cN){var cO;cO=e.KeyValue(cN);return cM.replace(new a.RegExp("\\${"+cO[0]+"}","ig"),"${"+cO[1]+"}");}cK=_0.get(cH,cI);return cG.setAttribute(cK,(((cw.Curried3(x.fold))(cL))(cG.getAttribute(cK)))(cE));}());});};bU.fill=function(cD,cE,cF){while(true)if(cD.hasChildNodes())cF=cE.insertBefore(cD.lastChild,cF);else return null;};bU.convertAttrs=function(cD){var cF,cG,cH,cI,cJ,cK,cL,cM;function cE(cN){var cO;cO=cD.getAttribute(cN);cO===null?void 0:cD.setAttribute(cN,cO.toLowerCase());}cF=cD.attributes;cG=[];cH=[];cI=[];for(cJ=0,cK=cF.length-1;cJ<=cK;cJ++){cL=cF.item(cJ);bL.StartsWith(cL.nodeName,"ws-on")&&cL.nodeName!=="ws-onafterrender"&&cL.nodeName!=="ws-on"?(cG.push(cL.nodeName),cH.push(bV.string(cL.nodeName,{$:1,$0:"ws-on".length},null)+":"+cL.nodeValue.toLowerCase())):!bL.StartsWith(cL.nodeName,"ws-")&&(new a.RegExp(H.TextHoleRE())).test(cL.nodeValue)?(cL.nodeValue=(cM=new a.RegExp(H.TextHoleRE(),"g"),cL.nodeValue.replace(cM,function(cN,cO){return"${"+cO.toLowerCase()+"}";})),cI.push(cL.nodeName)):void 0;}!(cH.length==0)?cD.setAttribute("ws-on",bL.concat(" ",cH)):void 0;!(cI.length==0)?cD.setAttribute("ws-attr-holes",bL.concat(" ",cI)):void 0;cE("ws-hole");cE("ws-replace");cE("ws-attr");cE("ws-onafterrender");cE("ws-var");_0.iter(function(cN){cD.removeAttribute(cN);},cG);};bV.string=function(cD,cE,cF){return cE==null?cF!=null&&cF.$==1?cD.slice(0,cF.$0+1):"":cF==null?cD.slice(cE.$0):cD.slice(cE.$0,cF.$0+1);};bW=v.KeyCollection=cw.Class({GetEnumerator$1:function(){return T.Get(x.map(function(cD){return cD.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},o,bW);bW.New=cw.Ctor(function(cD){o.New.call(this);this.d=cD;},bW);bY.get_UseAnimations=function(){return ce.UseAnimations();};bY.Play=function(cD){var cE;cE=null;return bd.Delay(function(){return bd.Bind(bY.Run(a.ignore,ce.Actions(cD)),function(){ce.Finalize(cD);return bd.Return(null);});});};bY.Append=function(cD,cE){return{$:0,$0:ck.Append(cD.$0,cE.$0)};};bY.Run=function(cD,cE){var cF;function cG(cH){function cI(cJ,cK){var cL;cL=cK-cJ;cE.Compute(cL);cD();return cL<=cF?void a.requestAnimationFrame(function(cM){cI(cJ,cM);}):cH();}a.requestAnimationFrame(function(cJ){cI(cJ,cJ);});}cF=cE.Duration;return cF===0?bd.Zero():bd.FromContinuations(function(cH,cI,cJ){return cG.apply(null,[cH,cI,cJ]);});};bY.Concat=function(cD){return{$:0,$0:ck.Concat(x.map(ce.List,cD))};};bY.get_Empty=function(){return{$:0,$0:ck.Empty()};};bZ.BatchUpdatesEnabled=function(){cf.$cctor();return cf.BatchUpdatesEnabled;};b0.StartProcessor=function(cD){var cE;function cF(){var cG;cG=null;return bd.Delay(function(){return bd.Bind(cD,function(){var cH;cH=cE[0];return cH===1?(cE[0]=0,bd.Zero()):cH===2?(cE[0]=1,cF()):bd.Zero();});});}cE=[0];return function(){var cG;cG=cE[0];cG===0?(cE[0]=1,bd.Start(cF(),null)):cG===1?cE[0]=2:void 0;};};b1.New=function(cD,cE){return{c:cD,r:cE};};bC.Obsolete=function(cD){var cE,cF,cG,cH,cI;cF=cD.s;if(cF==null||(cF!=null&&cF.$==2?(cE=cF.$1,false):cF!=null&&cF.$==3?(cE=cF.$1,false):true))void 0;else{cD.s=null;for(cG=0,cH=_0.length(cE)-1;cG<=cH;cG++){cI=_0.get(cE,cG);typeof cI=="object"?function(cJ){bC.Obsolete(cJ);}(cI):cI();}}};bC.New=function(cD){return{s:cD};};b3.New=function(cD,cE,cF,cG){var cH;cH={DynElem:cD,DynFlags:cE,DynNodes:cF};cw.SetOptional(cH,"OnAfterRender",cG);return cH;};b4=d.InvalidOperationException=cw.Class({},bH,b4);b4.New=cw.Ctor(function(cD){b4.New$2.call(this,cD,null);},b4);b4.New$2=cw.Ctor(function(cD,cE){this.message=cD;this.inner=cE;_1.setPrototypeOf(this,b4.prototype);},b4);b5=bd.Scheduler=cw.Class({Fork:function(cD){var cE;cE=this;this.robin.push(cD);this.idle?(this.idle=false,a.setTimeout(function(){cE.tick();},0)):void 0;},tick:function(){var cD,cE,cF;cE=this;cF=cB.now();cD=true;while(cD)if(this.robin.length===0){this.idle=true;cD=false;}else{(this.robin.shift())();cB.now()-cF>40?(a.setTimeout(function(){cE.tick();},0),cD=false):void 0;}}},o,b5);b5.New=cw.Ctor(function(){o.New.call(this);this.idle=true;this.robin=[];},b5);b6=d.CancellationTokenSource=cw.Class({},o,b6);b6.New=cw.Ctor(function(){o.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},b6);b7=D.FromView=cw.Class({UpdateMaybe:function(cD){var cE;cE=this;Y.Get(function(cF){var cG;cG=cD(cF);cG!=null&&cG.$==1?cE.set(cG.$0):void 0;},this.view);},Set:function(cD){this.set(cD);},get_View:function(){return this.view;},Get:function(){return this.current;},Update:function(cD){var cE;Y.Get((cE=this.set,function(cF){return cE(cD(cF));}),this.view);}},E,b7);b7.New=cw.Ctor(function(cD,cE){var cF,cG;cF=this;E.New.call(this);this.set=cE;this.id=bv.Int();this.current=(cG=Y.TryGet(cD),cG==null?null:cG.$0);this.view=Y.Map(function(cH){cF.current=cH;return cH;},cD);},b7);b8=D.CheckedInput=cw.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,b8);b9.ofSeqNonCopying=function(cD){var cE,cF;if(cD instanceof a.Array)return cD;else if(cD instanceof bc)return _0.ofList(cD);else if(cD===null)return[];else{cE=[];cF=T.Get(cD);try{while(cF.MoveNext())cE.push(cF.Current());return cE;}finally{if(typeof cF=="object"&&"Dispose"in cF)cF.Dispose();}}};b9.TreeReduce=function(cD,cE,cF){var cG;function cH(cI,cJ){var cK,cL;return cJ<=0?cD:cJ===1&&(cI>=0&&cI<cG)?_0.get(cF,cI):(cL=cJ/2>>0,cE(cH(cI,cL),cH(cI+cL,cJ-cL)));}cG=_0.length(cF);return cH(0,cG);};b9.mapInPlace=function(cD,cE){var cF,cG;for(cF=0,cG=cE.length-1;cF<=cG;cF++)cE[cF]=cD(cE[cF]);return cE;};b9.MapTreeReduce=function(cD,cE,cF,cG){var cH;function cI(cJ,cK){var cL,cM;return cK<=0?cE:cK===1&&(cJ>=0&&cJ<cH)?cD(_0.get(cG,cJ)):(cM=cK/2>>0,cF(cI(cJ,cM),cI(cJ+cM,cK-cM)));}cH=_0.length(cG);return cI(0,cH);};b_=D.DynamicAttrNode=cw.Class({NGetExitAnim:function(cD){return bY.get_Empty();},NGetEnterAnim:function(cD){return bY.get_Empty();},NGetChangeAnim:function(cD){return bY.get_Empty();},NChanged:function(){return this.updates;},NSync:function(cD){if(this.dirty){(this.push(cD))(this.value);this.dirty=false;}}},o,b_);b_.New=cw.Ctor(function(cD,cE){var cF;cF=this;o.New.call(this);this.push=cE;this.value=void 0;this.dirty=false;this.updates=Y.Map(function(cG){cF.value=cG;cF.dirty=true;},cD);},b_);b$.$cctor=function(){b$.$cctor=a.ignore;b$.counter=0;};ca.$cctor=function(){ca.$cctor=a.ignore;function cD(cE){var cF,cG;cF=(cG=0,[_8.TryParseInt32(cE,{get:function(){return cG;},set:function(cH){cG=cH;}}),cG]);return cF[0]?{$:1,$0:cF[1]}:null;}ca.Empty=bJ.New$1(function(){return[];},function(){return null;});ca.rRoot=bJ.New(function(cE){return[cE];},[]);ca.rString=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=ch.read(cF.$0),cG!=null&&cG.$==1?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG.$0]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(cE==null?"null":ch.write(cE))]};});ca.rChar=bJ.New$1(function(cE){var cF,cG,cH;cF=cE.Segments;return cF.$==1?(cG=ch.read(cF.$0),cG!=null&&cG.$==1&&(cG.$0.length===1&&(cH=cG.$0,true))?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),ci.Parse(cH)]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(cE)]};});ca.rGuid=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=null,bP.TryParse(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rInt=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseInt32(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rDouble=bJ.New$1(function(cE){var cF,cG,cH;cF=cE.Segments;return cF.$==1?(cG=0,(cH=cy(cF.$0),a.isNaN(cH)?false:(cG=cH,true))?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rSByte=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseSByte(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rByte=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseByte(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rInt16=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseInt16(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rUInt16=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseUInt16(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rUInt=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseUInt32(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rInt64=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseInt64(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rUInt64=bJ.New$1(function(cE){var cF,cG;cF=cE.Segments;return cF.$==1?(cG=0,_8.TryParseUInt64(cF.$0,{get:function(){return cG;},set:function(cH){cG=cH;}})?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rSingle=bJ.New$1(function(cE){var cF,cG,cH;cF=cE.Segments;return cF.$==1?(cG=0,(cH=cy(cF.$0),a.isNaN(cH)?false:(cG=cH,true))?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(a.String(cE))]};});ca.rBool=bJ.New$1(function(cE){var cF,cG,cH;cF=cE.Segments;return cF.$==1?(cG=(cH=null,[_8.TryParseBool(cF.$0,{get:function(){return cH;},set:function(cI){cH=cI;}}),cH]),cG[0]?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),cG[1]]]:[]):[];},function(cE){return{$:1,$0:[be.Segment$2(cE?"True":"False")]};});ca.rWildcard=bJ.New$1(function(cE){return[[be.New(bc.Empty,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),bL.concat("/",cE.Segments)]];},function(cE){return{$:1,$0:[be.Segment$2(cE)]};});ca.rDateTime=bJ.New$1(function(cE){var cF,cG,cH,cI,cJ,cK,cL,cM,cN;cF=cE.Segments;return cF.$==1?(cG=cF.$0,cG.length===19&&cG[4]==="-"&&cG[7]==="-"&&cG[10]==="-"&&cG[13]==="."&&cG[16]==="."?(cH=cD(bV.string(cG,{$:1,$0:0},{$:1,$0:3})),(cI=cD(bV.string(cG,{$:1,$0:5},{$:1,$0:6})),(cJ=cD(bV.string(cG,{$:1,$0:8},{$:1,$0:9})),(cK=cD(bV.string(cG,{$:1,$0:11},{$:1,$0:12})),(cL=cD(bV.string(cG,{$:1,$0:14},{$:1,$0:15})),(cM=cD(bV.string(cG,{$:1,$0:17},{$:1,$0:18})),cH!=null&&cH.$==1&&(cI!=null&&cI.$==1&&(cJ!=null&&cJ.$==1&&(cK!=null&&cK.$==1&&(cL!=null&&cL.$==1&&(cM!=null&&cM.$==1&&(cN=[cJ.$0,cK.$0,cI.$0,cL.$0,cM.$0,cH.$0],true))))))?[[be.New(cF.$1,cE.QueryArgs,cE.FormData,cE.Method,cE.Body),(new cB(cN[5],cN[2]-1,cN[0],cN[1],cN[3],cN[4])).getTime()]]:[])))))):[]):[];},function(cE){var cF,cG;function cH(cI){var cJ;cJ=a.String(cI);return cJ.length===1?"0"+cJ:cJ;}return{$:1,$0:[be.Segment$2((cF=a.String((new cB(cE)).getFullYear()),(cG=cF.length,cG===1?"000"+cF:cG===2?"00"+cF:cG===3?"0"+cF:cF))+"-"+cH((new cB(cE)).getMonth()+1)+"-"+cH((new cB(cE)).getDate())+"-"+cH((new cB(cE)).getHours())+"."+cH((new cB(cE)).getMinutes())+"."+cH((new cB(cE)).getSeconds()))]};});};cc.New=function(cD,cE){return{PreviousNodes:cD,Top:cE};};cd.get_Empty=function(){return{$:0,$0:new by.New$3()};};cd.FindAll=function(cD){var cE;function cF(cH){if(cH!=null&&cH.$==0){cF(cH.$0);cF(cH.$1);}else if(cH!=null&&cH.$==1)cG(cH.$0);else if(cH!=null&&cH.$==2)cF(cH.$0.Current);else if(cH!=null&&cH.$==6)_0.iter(cG,cH.$0.Holes);}function cG(cH){cE.push(cH);cF(cH.Children);}cE=[];cF(cD);return{$:0,$0:new by.New$2(cE)};};cd.Filter=function(cD,cE){return{$:0,$0:co.Filter(cD,cE.$0)};};cd.Except=function(cD,cE){return{$:0,$0:co.Except(cD.$0,cE.$0)};};cd.ToArray=function(cD){return co.ToArray(cD.$0);};cd.Intersect=function(cD,cE){return{$:0,$0:co.Intersect(cD.$0,cE.$0)};};ce.UseAnimations=function(){cj.$cctor();return cj.UseAnimations;};ce.Actions=function(cD){return ce.ConcatActions(_0.choose(function(cE){return cE.$==1?{$:1,$0:cE.$0}:null;},ck.ToArray(cD.$0)));};ce.Finalize=function(cD){_0.iter(function(cE){if(cE.$==0)cE.$0();},ck.ToArray(cD.$0));};ce.ConcatActions=function(cD){var cE,cF,cG,cH;cE=b9.ofSeqNonCopying(cD);cF=_0.length(cE);return cF===0?ce.Const():cF===1?_0.get(cE,0):(cG=x.max(x.map(function(cI){return cI.Duration;},cE)),(cH=_0.map(function(cI){return ce.Prolong(cG,cI);},cE),ce.Def(cG,function(cI){_0.iter(function(cJ){cJ.Compute(cI);},cH);})));};ce.List=function(cD){return cD.$0;};ce.Const=function(cD){return ce.Def(0,function(){return cD;});};ce.Def=function(cD,cE){return{Compute:cE,Duration:cD};};ce.Prolong=function(cD,cE){var cF,cG,cH;cF=cE.Compute;cG=cE.Duration;cH=N.Create(function(){return cE.Compute(cE.Duration);});return{Compute:function(cI){return cI>=cG?cH.f():cF(cI);},Duration:cD};};cf.$cctor=function(){cf.$cctor=a.ignore;cf.BatchUpdatesEnabled=true;};cg=d.OperationCanceledException=cw.Class({},bH,cg);cg.New=cw.Ctor(function(cD){cg.New$1.call(this,"The operation was canceled.",null,cD);},cg);cg.New$1=cw.Ctor(function(cD,cE,cF){this.message=cD;this.inner=cE;_1.setPrototypeOf(this,cg.prototype);this.ct=cF;},cg);bJ.New=function(cD,cE){return{Parse:cD,Segment:cE};};ch.read=function(cD){var cE;cE=[];return function(cF){var cG;while(true){cG=ch.readEscapedFromChars(cF);if(cG[0]===-2)return null;else if(cG[0]===-1)return{$:1,$0:(function(cH){return function(cI){return bL.concat(cH,cI);};}(""))(cE)};else{cE.push(cC.fromCharCode(cG[0]));cF=cG[1];}}}(S.ofSeq(x.map(function(cF){return cF.charCodeAt();},cD)));};ch.write=function(cD){return bL.concat("",x.mapi(function(cE,cF){return ch.writeEscapedAsString(cE+1===cD.length,cF);},cD));};ch.readEscapedFromChars=function(cD){var cE,cF,cG,cH,cI,cJ,cK,cL;function cM(){var cO,cP;return cE.$==1?(cO=cE.$1,(cP=cE.$0,(cE=cO,cP))):-1;}function cN(cO){return cO>="0".charCodeAt()&&cO<="9".charCodeAt()?cO-"0".charCodeAt():cO>="a".charCodeAt()&&cO<="f".charCodeAt()?cO-"a".charCodeAt()+10:cO>="A".charCodeAt()&&cO<="F".charCodeAt()?cO-"A".charCodeAt()+10:-2;}cE=cD;return[(cF=cM(),cF==="~".charCodeAt()?(cG=cM(),cG==="u".charCodeAt()?(cH=cM(),(cI=cM(),(cJ=cM(),(cK=cM(),cH>=0&&cI>=0&&cJ>=0&&cK>=0?ch.op_PlusPlus(ch.op_PlusPlus(ch.op_PlusPlus(cN(cH),cN(cI)),cN(cJ)),cN(cK)):-2)))):(cL=cM(),cG>=0&&cL>=0?ch.op_PlusPlus(cN(cG),cN(cL)):-2)):cF),cE];};ch.writeEscapedAsString=function(cD,cE){var cF;cF=cE.charCodeAt();return ch.isUnreserved(cD,cE)?cE:cF<256?"~"+bL.PadLeftWith(cF.toString(16),2,"0"):"~u"+bL.PadLeftWith(cF.toString(16),4,"0");};ch.op_PlusPlus=function(cD,cE){return(cD<<4)+cE;};ch.isUnreserved=function(cD,cE){return cE==="-"||(cE==="."?!cD:cE==="_"||(cE>="A"&&cE<="Z"||(cE>="a"&&cE<="z"||cE>="0"&&cE<="9")));};ci.Parse=function(cD){return cD.length===1?cD:e.FailWith("String must be exactly one character long.");};ci.IsWhiteSpace=function(cD){return cD.match(new a.RegExp("\\s"))!==null;};_8.TryParseSByte=function(cD,cE){return _8.TryParse(cD,-128,127,cE);};_8.TryParseByte=function(cD,cE){return _8.TryParse(cD,0,255,cE);};_8.TryParseInt16=function(cD,cE){return _8.TryParse(cD,-32768,32767,cE);};_8.TryParseUInt16=function(cD,cE){return _8.TryParse(cD,0,65535,cE);};_8.TryParseUInt32=function(cD,cE){return _8.TryParse(cD,0,4294967295,cE);};_8.TryParseInt64=function(cD,cE){return _8.TryParse(cD,-9223372036854775808,9223372036854775807,cE);};_8.TryParseUInt64=function(cD,cE){return _8.TryParse(cD,0,18446744073709551615,cE);};cj.$cctor=function(){cj.$cctor=a.ignore;cj.CubicInOut=cn.Custom(function(cD){var cE;cE=cD*cD;return 3*cE-2*(cE*cD);});cj.UseAnimations=true;};ck.Append=function(cD,cE){return cD.$==0?cE:cE.$==0?cD:{$:2,$0:cD,$1:cE};};ck.ToArray=function(cD){var cE;function cF(cG){if(cG.$==1)cE.push(cG.$0);else if(cG.$==2){cF(cG.$0);cF(cG.$1);}else if(cG.$==3)_0.iter(function(cH){cE.push(cH);},cG.$0);}cE=[];cF(cD);return cE.slice(0);};ck.Concat=function(cD){var cE;cE=b9.ofSeqNonCopying(cD);return b9.TreeReduce(ck.Empty(),ck.Append,cE);};ck.Empty=function(){cs.$cctor();return cs.Empty;};cl.concat=function(cD){var cE,cF;cE=[];for(var cG in cD)cE.push.apply(cE,cD[cG]);return cE;};cm.$cctor=function(){cm.$cctor=a.ignore;cm.EmptyAttr=null;};_8.TryParse=function(cD,cE,cF,cG){var cH,cI;cH=+cD;cI=cH===cH-cH%1&&cH>=cE&&cH<=cF;cI?cG.set(cH):void 0;return cI;};_8.TryParseBool=function(cD,cE){var cF;cF=cD.toLowerCase();return cF==="true"?(cE.set(true),true):cF==="false"&&(cE.set(false),true);};cn=D.Easing=cw.Class({},o,cn);cn.Custom=function(cD){return new cn.New(cD);};cn.New=cw.Ctor(function(cD){o.New.call(this);this.transformTime=cD;},cn);co.Filter=function(cD,cE){return new by.New$2(_0.filter(cD,co.ToArray(cE)));};co.Except=function(cD,cE){var cF;cF=new by.New$2(co.ToArray(cE));cF.ExceptWith(co.ToArray(cD));return cF;};co.ToArray=function(cD){var cE;cE=_0.create(cD.get_Count(),void 0);cD.CopyTo(cE);return cE;};co.Intersect=function(cD,cE){var cF;cF=new by.New$2(co.ToArray(cD));cF.IntersectWith(co.ToArray(cE));return cF;};cp.Clear=function(cD){cD.splice(0,_0.length(cD));};cq.Children=function(cD,cE){var cF,cG,cH;if(cE!=null&&cE.$==1){cH=[];cF=cE.$0[0].nextSibling;while(cF!==cE.$0[1]){cH.push(cF);cF=cF.nextSibling;}return{$:0,$0:cH};}else return{$:0,$0:_0.init(cD.childNodes.length,(cG=cD.childNodes,function(cI){return cG[cI];}))};};cq.Except=function(cD,cE){var cF;cF=cD.$0;return{$:0,$0:_0.filter(function(cG){return _0.forall(function(cH){return!(cG===cH);},cF);},cE.$0)};};cq.Iter=function(cD,cE){_0.iter(cD,cE.$0);};cq.DocChildren=function(cD){var cE;function cF(cG){if(cG!=null&&cG.$==2)cF(cG.$0.Current);else if(cG!=null&&cG.$==1)cE.push(cG.$0.El);else if(cG==null);else if(cG!=null&&cG.$==5)cE.push(cG.$0);else if(cG!=null&&cG.$==4)cE.push(cG.$0.Text);else if(cG!=null&&cG.$==6)_0.iter(function(cH){if(cH==null||cH.constructor===_1)cF(cH);else cE.push(cH);},cG.$0.Els);else{cF(cG.$0);cF(cG.$1);}}cE=[];cF(cD.Children);return{$:0,$0:b9.ofSeqNonCopying(cE)};};cr.isBlank=function(cD){return bL.forall(ci.IsWhiteSpace,cD);};cs.$cctor=function(){cs.$cctor=a.ignore;cs.Empty={$:0};};ct=d.FormatException=cw.Class({},bH,ct);ct.New$1=cw.Ctor(function(cD){this.message=cD;_1.setPrototypeOf(this,ct.prototype);},ct);cw.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
